2024-05-27 23:23:53,491 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:294)
2024-05-27 23:23:53,654 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:290)
2024-05-27 23:23:53,746 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__dtb (evaluator.py:265)
2024-05-27 23:23:53,746 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-27 23:23:53,747 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-27 23:23:53,747 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__dtb' AND table_name IN ('dtb__territorio__3564516099__temp', 'dtb__territorio__3564516099') (base.py:1822)
2024-05-27 23:23:53,765 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__bps (evaluator.py:265)
2024-05-27 23:23:53,766 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-27 23:23:53,766 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-27 23:23:53,767 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__bps' AND table_name IN ('bps__compras__3829882676__temp', 'bps__materiais__3533423352__temp', 'bps__unidades__25746938', 'bps__materiais__3533423352', 'bps__compras__3829882676', 'bps__unidades__25746938__temp') (base.py:1822)
2024-05-27 23:23:53,771 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__siasg (evaluator.py:265)
2024-05-27 23:23:53,771 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-27 23:23:53,772 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-27 23:23:53,772 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__siasg' AND table_name IN ('siasg__unidades__3458370508', 'siasg__compras__1111392831', 'siasg__materiais__382104304__temp', 'siasg__unidades__3458370508__temp', 'siasg__uasgs__3746688468', 'siasg__compras__1111392831__temp', 'siasg__uasgs__3746688468__temp', 'siasg__materiais__382104304') (base.py:1822)
2024-05-27 23:23:53,788 - MainThread - sqlmesh.core.state_sync.common - INFO - Promoting environment 'prod' (common.py:120)
2024-05-27 23:23:53,818 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"db"."bps"."compras": 1485750405> (common.py:225)
2024-05-27 23:23:53,823 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.bps' (evaluator.py:849)
2024-05-27 23:23:53,824 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."bps" (base.py:1822)
2024-05-27 23:23:53,824 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.bps.compras' to point at table 'db.sqlmesh__bps.bps__compras__3829882676' (evaluator.py:1111)
2024-05-27 23:23:53,824 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."bps"."compras" AS SELECT * FROM "db"."sqlmesh__bps"."bps__compras__3829882676" (base.py:1822)
2024-05-27 23:23:53,825 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."bps"."compras"."data_compra" IS 'data da compra (homologação do processo de compra)' (base.py:1822)
2024-05-27 23:23:53,825 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."bps"."compras"."codigo_compra" IS 'Identificador da compra (siasg)' (base.py:1822)
2024-05-27 23:23:53,825 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."bps"."compras"."codigo_item_compra" IS 'Identificador do item da compra (siasg)' (base.py:1822)
2024-05-27 23:23:53,825 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."bps"."compras"."codigo_item_catalogo" IS 'Código do item no catálogo (siasg); código da categoria do material' (base.py:1822)
2024-05-27 23:23:53,825 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."bps"."compras"."codigo_unidade_fornecimento" IS 'Identificador da unidade de fornecimento (bps)' (base.py:1822)
2024-05-27 23:23:53,825 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."bps"."compras"."codigo_uasg" IS 'identificador da unidade de gestão no governo (siasg)' (base.py:1822)
2024-05-27 23:23:53,826 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."bps"."compras"."cnpj_fornecedor" IS 'CNPJ do fornecedor (estrangeiros não possuem CNPJ)' (base.py:1822)
2024-05-27 23:23:53,826 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."bps"."compras"."fornecedor" IS 'nome do fornecedor' (base.py:1822)
2024-05-27 23:23:53,826 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."bps"."compras"."marca_fabricante" IS 'marca do item comprado' (base.py:1822)
2024-05-27 23:23:53,826 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."bps"."compras"."quantidade" IS 'quantidade compra (em unidades de fornecimento)' (base.py:1822)
2024-05-27 23:23:53,826 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."bps"."compras"."preco_unitario" IS 'preço de uma unidade de fornecimento do material comprado' (base.py:1822)
2024-05-27 23:23:53,827 - MainThread - sqlmesh.core.state_sync.common - INFO - Finalizing environment 'prod' (common.py:198)
2024-05-27 23:23:53,851 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
