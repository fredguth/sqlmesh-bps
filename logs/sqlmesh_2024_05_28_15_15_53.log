2024-05-28 15:15:53,898 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'data/catalog.db'} (connection.py:294)
2024-05-28 15:15:54,072 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: data/catalog.db (connection.py:290)
2024-05-28 15:15:55,942 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema catalog.sqlmesh__dtb (evaluator.py:265)
2024-05-28 15:15:55,943 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 15:15:55,945 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 15:15:55,946 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__dtb' AND table_name IN ('dtb__territorio__3564516099', 'dtb__territorio__3564516099__temp') (base.py:1822)
2024-05-28 15:15:55,975 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema catalog.sqlmesh__bps (evaluator.py:265)
2024-05-28 15:15:55,976 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 15:15:55,976 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 15:15:55,977 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__bps' AND table_name IN ('bps__unidades__3794497381', 'bps__precos__3689629057__temp', 'bps__unidades__3794497381__temp', 'bps__precos__3689629057', 'bps__materiais__4088563816__temp', 'bps__materiais__4088563816') (base.py:1822)
2024-05-28 15:15:55,982 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema catalog.sqlmesh__siasg (evaluator.py:265)
2024-05-28 15:15:55,982 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 15:15:55,982 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 15:15:55,984 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__siasg' AND table_name IN ('siasg__unidades__3458370508', 'siasg__uasgs__3746688468', 'siasg__compras__1111392831', 'siasg__materiais__382104304', 'siasg__unidades__3458370508__temp', 'siasg__materiais__382104304__temp', 'siasg__uasgs__3746688468__temp', 'siasg__compras__1111392831__temp') (base.py:1822)
2024-05-28 15:15:55,999 - MainThread - sqlmesh.core.state_sync.common - INFO - Promoting environment 'prod' (common.py:120)
2024-05-28 15:15:56,015 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Altering table 'catalog.sqlmesh__dtb.dtb__territorio__3564516099' (evaluator.py:1199)
2024-05-28 15:15:56,015 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "catalog"."sqlmesh__dtb"."dtb__territorio__3564516099" (base.py:1822)
2024-05-28 15:15:56,016 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "catalog"."sqlmesh__dtb"."dtb__territorio__3564516099__temp" (base.py:1822)
2024-05-28 15:15:56,020 - MainThread - sqlmesh.core.state_sync.common - INFO - Pausing snapshot SnapshotId<"catalog"."dtb"."territorio": 4040480099> (common.py:246)
2024-05-28 15:15:56,020 - MainThread - sqlmesh.core.state_sync.common - INFO - Marking snapshot SnapshotId<"catalog"."dtb"."territorio": 4040480099> as unrestorable (common.py:255)
2024-05-28 15:15:56,022 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"catalog"."dtb"."territorio": 426115250> (common.py:225)
2024-05-28 15:15:56,027 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'catalog.dtb' (evaluator.py:849)
2024-05-28 15:15:56,028 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "catalog"."dtb" (base.py:1822)
2024-05-28 15:15:56,028 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.dtb.territorio' to point at table 'catalog.sqlmesh__dtb.dtb__territorio__3564516099' (evaluator.py:1111)
2024-05-28 15:15:56,028 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."dtb"."territorio" AS SELECT * FROM "catalog"."sqlmesh__dtb"."dtb__territorio__3564516099" (base.py:1822)
2024-05-28 15:15:56,029 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON VIEW "catalog"."dtb"."territorio" IS 'Divisão Territorial Brasileira: Apresenta a relação de subdistritos, distritos e municípios que compõem a divisão territorial brasileira oficial segundo o IBGE.' (base.py:1822)
2024-05-28 15:15:56,029 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."codigo_regiao" IS 'código ibge para as regioes brasileiras: 1=Norte;2=Nordeste;3=Sudeste;4=Sul;5=Centro-Oeste' (base.py:1822)
2024-05-28 15:15:56,029 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."nome_regiao" IS 'nome da região: Norte, Nordeste, Sudeste, Sul, Centro-Oeste' (base.py:1822)
2024-05-28 15:15:56,029 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."codigo_uf" IS 'código do ibge com dois digitos que representam unicamente cada unidade da federação' (base.py:1822)
2024-05-28 15:15:56,030 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."sigla_uf" IS 'sigla da unidade da federação' (base.py:1822)
2024-05-28 15:15:56,030 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."nome_uf" IS 'nome da unidade da federação' (base.py:1822)
2024-05-28 15:15:56,030 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."codigo_regiao_geografica_intermediaria" IS 'código ibge que identifica unicamente cada região geográfica intermediária' (base.py:1822)
2024-05-28 15:15:56,030 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."regiao_geografica_intermediaria" IS 'região geográfica intermediária' (base.py:1822)
2024-05-28 15:15:56,030 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."codigo_regiao_geografica_imediata" IS 'código ibge que identifica unicamente cada região geográfica imediata' (base.py:1822)
2024-05-28 15:15:56,030 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."regiao_geografica_imediata" IS 'região geográfica imediata' (base.py:1822)
2024-05-28 15:15:56,031 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."codigo_mesorregiao" IS 'código ibge que identifica unicamente cada mesorregião' (base.py:1822)
2024-05-28 15:15:56,031 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."nome_mesoregiao" IS 'nome da mesorregião' (base.py:1822)
2024-05-28 15:15:56,031 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."codigo_microrregiao" IS 'código ibge que identifica unicamente cada microrregião' (base.py:1822)
2024-05-28 15:15:56,031 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."nome_microrregiao" IS 'nome da microrregião' (base.py:1822)
2024-05-28 15:15:56,031 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."codigo_municipio_5" IS 'código ibge que identifica unicamente cada município com 5 dígitos' (base.py:1822)
2024-05-28 15:15:56,031 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."codigo_municipio_6" IS 'código ibge que identifica unicamente cada município com 6 dígitos' (base.py:1822)
2024-05-28 15:15:56,032 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."codigo_municipio_7" IS 'código ibge que identifica unicamente cada município com 7 dígitos' (base.py:1822)
2024-05-28 15:15:56,032 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."dtb"."territorio"."nome_municipio" IS 'nome oficial do município' (base.py:1822)
2024-05-28 15:15:56,032 - MainThread - sqlmesh.core.state_sync.common - INFO - Finalizing environment 'prod' (common.py:198)
2024-05-28 15:15:56,052 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
