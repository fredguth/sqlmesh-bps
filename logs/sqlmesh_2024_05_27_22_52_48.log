2024-05-27 22:52:48,027 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:294)
2024-05-27 22:52:48,251 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:290)
2024-05-27 22:52:50,695 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__dtb (evaluator.py:265)
2024-05-27 22:52:50,695 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-27 22:52:50,697 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-27 22:52:50,698 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__dtb' AND table_name IN ('dtb__territorio__3564516099', 'dtb__territorio__3564516099__temp') (base.py:1822)
2024-05-27 22:52:50,730 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__bps (evaluator.py:265)
2024-05-27 22:52:50,730 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-27 22:52:50,730 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-27 22:52:50,731 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__bps' AND table_name IN ('bps__compras__3191747747__temp', 'bps__materiais__3533423352__temp', 'bps__materiais__3533423352', 'bps__unidades__25746938__temp', 'bps__unidades__25746938', 'bps__compras__3191747747') (base.py:1822)
2024-05-27 22:52:50,736 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__siasg (evaluator.py:265)
2024-05-27 22:52:50,736 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-27 22:52:50,736 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-27 22:52:50,737 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__siasg' AND table_name IN ('siasg__unidades__3458370508__temp', 'siasg__compras__1111392831__temp', 'siasg__uasgs__3746688468__temp', 'siasg__uasgs__3746688468', 'siasg__materiais__382104304', 'siasg__materiais__382104304__temp', 'siasg__compras__1111392831', 'siasg__unidades__3458370508') (base.py:1822)
2024-05-27 22:52:50,746 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__dtb' (evaluator.py:849)
2024-05-27 22:52:50,746 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__dtb" (base.py:1822)
2024-05-27 22:52:50,746 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__bps' (evaluator.py:849)
2024-05-27 22:52:50,746 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__bps" (base.py:1822)
2024-05-27 22:52:50,746 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__siasg' (evaluator.py:849)
2024-05-27 22:52:50,746 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__siasg" (base.py:1822)
2024-05-27 22:52:50,754 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__bps.bps__compras__3191747747__temp' (evaluator.py:1155)
2024-05-27 22:52:50,756 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__bps"."bps__compras__3191747747__temp" AS SELECT DISTINCT "c"."codigo_compra" AS "codigo_compra", "c"."codigo_item_compra" AS "codigo_item_compra", "c"."codigo_item_catalogo" AS "codigo_item_catalogo", "c"."sigla_tipo_unidade_fornecimento" AS "sigla_tipo_unidade_fornecimento", "c"."tipo_unidade_fornecimento" AS "tipo_unidade_fornecimento", "c"."unidade_medida" AS "unidade_medida", "c"."capacidade_unidade_fornecimento" AS "capacidade_unidade_fornecimento", "c"."quantidade" AS "quantidade", "c"."preco_unitario" AS "preco_unitario", "c"."cnpj_fornecedor" AS "cnpj_fornecedor", "c"."fornecedor" AS "fornecedor", "c"."marca_fabricante" AS "marca_fabricante", "c"."codigo_uasg" AS "codigo_uasg", "c"."data_compra" AS "data_compra", "m"."codigo_pdm" AS "codigo_pdm" FROM (SELECT "compras"."idCompra" AS "codigo_compra", "compras"."idItemCompra" AS "codigo_item_compra", "compras"."codigoItemCatalogo" AS "codigo_item_catalogo", "compras"."siglaUnidadeFornecimento" AS "sigla_tipo_unidade_fornecimento", "compras"."nomeUnidadeFornecimento" AS "tipo_unidade_fornecimento", "compras"."siglaUnidadeMedida" AS "unidade_medida", "compras"."capacidadeUnidadeFornecimento" AS "capacidade_unidade_fornecimento", "compras"."quantidade" AS "quantidade", "compras"."precoUnitario" AS "preco_unitario", "compras"."niFornecedor" AS "cnpj_fornecedor", "compras"."nomeFornecedor" AS "fornecedor", "compras"."marca" AS "marca_fabricante", "compras"."codigoUasg" AS "codigo_uasg", "compras"."dataCompra" AS "data_compra" FROM "db"."sqlmesh__siasg"."siasg__compras__1111392831" AS "compras" WHERE FALSE LIMIT 0) AS "c" LEFT JOIN "db"."sqlmesh__bps"."bps__materiais__3533423352" AS "m" ON "c"."codigo_item_catalogo" = "m"."codigo_item_catalogo" WHERE FALSE LIMIT 0 (base.py:1822)
2024-05-27 22:52:50,764 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__bps.bps__compras__3191747747' (evaluator.py:1155)
2024-05-27 22:52:50,765 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__bps"."bps__compras__3191747747" AS SELECT DISTINCT "c"."codigo_compra" AS "codigo_compra", "c"."codigo_item_compra" AS "codigo_item_compra", "c"."codigo_item_catalogo" AS "codigo_item_catalogo", "c"."sigla_tipo_unidade_fornecimento" AS "sigla_tipo_unidade_fornecimento", "c"."tipo_unidade_fornecimento" AS "tipo_unidade_fornecimento", "c"."unidade_medida" AS "unidade_medida", "c"."capacidade_unidade_fornecimento" AS "capacidade_unidade_fornecimento", "c"."quantidade" AS "quantidade", "c"."preco_unitario" AS "preco_unitario", "c"."cnpj_fornecedor" AS "cnpj_fornecedor", "c"."fornecedor" AS "fornecedor", "c"."marca_fabricante" AS "marca_fabricante", "c"."codigo_uasg" AS "codigo_uasg", "c"."data_compra" AS "data_compra", "m"."codigo_pdm" AS "codigo_pdm" FROM (SELECT "compras"."idCompra" AS "codigo_compra", "compras"."idItemCompra" AS "codigo_item_compra", "compras"."codigoItemCatalogo" AS "codigo_item_catalogo", "compras"."siglaUnidadeFornecimento" AS "sigla_tipo_unidade_fornecimento", "compras"."nomeUnidadeFornecimento" AS "tipo_unidade_fornecimento", "compras"."siglaUnidadeMedida" AS "unidade_medida", "compras"."capacidadeUnidadeFornecimento" AS "capacidade_unidade_fornecimento", "compras"."quantidade" AS "quantidade", "compras"."precoUnitario" AS "preco_unitario", "compras"."niFornecedor" AS "cnpj_fornecedor", "compras"."nomeFornecedor" AS "fornecedor", "compras"."marca" AS "marca_fabricante", "compras"."codigoUasg" AS "codigo_uasg", "compras"."dataCompra" AS "data_compra" FROM "db"."sqlmesh__siasg"."siasg__compras__1111392831" AS "compras" WHERE FALSE LIMIT 0) AS "c" LEFT JOIN "db"."sqlmesh__bps"."bps__materiais__3533423352" AS "m" ON "c"."codigo_item_catalogo" = "m"."codigo_item_catalogo" WHERE FALSE LIMIT 0 (base.py:1822)
2024-05-27 22:52:50,788 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."bps"."compras": 229218075> (evaluator.py:479)
2024-05-27 22:52:50,794 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-05-27 00:00:00+00:00, 2024-05-28 00:00:00+00:00) into db.sqlmesh__bps.bps__compras__3191747747' (evaluator.py:504)
2024-05-27 22:52:50,795 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__bps"."bps__compras__3191747747" (base.py:1822)
2024-05-27 22:52:50,797 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__bps"."bps__compras__3191747747" AS SELECT DISTINCT "c"."codigo_compra" AS "codigo_compra", "c"."codigo_item_compra" AS "codigo_item_compra", "c"."codigo_item_catalogo" AS "codigo_item_catalogo", "c"."sigla_tipo_unidade_fornecimento" AS "sigla_tipo_unidade_fornecimento", "c"."tipo_unidade_fornecimento" AS "tipo_unidade_fornecimento", "c"."unidade_medida" AS "unidade_medida", "c"."capacidade_unidade_fornecimento" AS "capacidade_unidade_fornecimento", "c"."quantidade" AS "quantidade", "c"."preco_unitario" AS "preco_unitario", "c"."cnpj_fornecedor" AS "cnpj_fornecedor", "c"."fornecedor" AS "fornecedor", "c"."marca_fabricante" AS "marca_fabricante", "c"."codigo_uasg" AS "codigo_uasg", "c"."data_compra" AS "data_compra", "m"."codigo_pdm" AS "codigo_pdm" FROM (SELECT "compras"."idCompra" AS "codigo_compra", "compras"."idItemCompra" AS "codigo_item_compra", "compras"."codigoItemCatalogo" AS "codigo_item_catalogo", "compras"."siglaUnidadeFornecimento" AS "sigla_tipo_unidade_fornecimento", "compras"."nomeUnidadeFornecimento" AS "tipo_unidade_fornecimento", "compras"."siglaUnidadeMedida" AS "unidade_medida", "compras"."capacidadeUnidadeFornecimento" AS "capacidade_unidade_fornecimento", "compras"."quantidade" AS "quantidade", "compras"."precoUnitario" AS "preco_unitario", "compras"."niFornecedor" AS "cnpj_fornecedor", "compras"."nomeFornecedor" AS "fornecedor", "compras"."marca" AS "marca_fabricante", "compras"."codigoUasg" AS "codigo_uasg", "compras"."dataCompra" AS "data_compra" FROM "db"."sqlmesh__siasg"."siasg__compras__1111392831" AS "compras") AS "c" LEFT JOIN "db"."sqlmesh__bps"."bps__materiais__3533423352" AS "m" ON "c"."codigo_item_catalogo" = "m"."codigo_item_catalogo" (base.py:1822)
2024-05-27 22:52:51,819 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1716768000000, 1716854400000) for snapshot SnapshotId<"db"."bps"."compras": 229218075> (engine_adapter.py:651)
2024-05-27 22:52:51,826 - MainThread - sqlmesh.core.state_sync.common - INFO - Promoting environment 'dev' (common.py:120)
2024-05-27 22:52:51,845 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.bps__dev' (evaluator.py:849)
2024-05-27 22:52:51,845 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."bps__dev" (base.py:1822)
2024-05-27 22:52:51,845 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.bps__dev.compras' to point at table 'db.sqlmesh__bps.bps__compras__3191747747' (evaluator.py:1111)
2024-05-27 22:52:51,846 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."bps__dev"."compras" AS SELECT * FROM "db"."sqlmesh__bps"."bps__compras__3191747747" (base.py:1822)
2024-05-27 22:52:51,846 - MainThread - sqlmesh.core.state_sync.common - INFO - Finalizing environment 'dev' (common.py:198)
2024-05-27 22:52:51,874 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
