2024-05-28 15:15:46,734 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'data/catalog.db'} (connection.py:294)
2024-05-28 15:15:46,977 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: data/catalog.db (connection.py:290)
2024-05-28 15:15:48,696 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema catalog.sqlmesh__dtb (evaluator.py:265)
2024-05-28 15:15:48,697 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 15:15:48,698 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 15:15:48,699 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__dtb' AND table_name IN ('dtb__territorio__3564516099', 'dtb__territorio__3564516099__temp') (base.py:1822)
2024-05-28 15:15:48,735 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema catalog.sqlmesh__bps (evaluator.py:265)
2024-05-28 15:15:48,735 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 15:15:48,735 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 15:15:48,736 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__bps' AND table_name IN ('bps__materiais__4088563816__temp', 'bps__unidades__3794497381__temp', 'bps__unidades__3794497381', 'bps__materiais__4088563816', 'bps__precos__3689629057__temp', 'bps__precos__3689629057') (base.py:1822)
2024-05-28 15:15:48,741 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema catalog.sqlmesh__siasg (evaluator.py:265)
2024-05-28 15:15:48,741 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 15:15:48,741 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 15:15:48,742 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__siasg' AND table_name IN ('siasg__uasgs__3746688468__temp', 'siasg__uasgs__3746688468', 'siasg__unidades__3458370508', 'siasg__unidades__3458370508__temp', 'siasg__materiais__382104304', 'siasg__compras__1111392831__temp', 'siasg__compras__1111392831', 'siasg__materiais__382104304__temp') (base.py:1822)
2024-05-28 15:15:48,763 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding dev interval (1716768000000, 1716854400000) for snapshot SnapshotId<"catalog"."dtb"."territorio": 426115250> (engine_adapter.py:651)
2024-05-28 15:15:48,772 - MainThread - sqlmesh.core.state_sync.common - INFO - Promoting environment 'dev' (common.py:120)
2024-05-28 15:15:48,807 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'catalog.dtb__dev' (evaluator.py:849)
2024-05-28 15:15:48,808 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "catalog"."dtb__dev" (base.py:1822)
2024-05-28 15:15:48,808 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.dtb__dev.territorio' to point at table 'catalog.sqlmesh__dtb.dtb__territorio__3564516099__temp' (evaluator.py:1111)
2024-05-28 15:15:48,808 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."dtb__dev"."territorio" AS SELECT * FROM "catalog"."sqlmesh__dtb"."dtb__territorio__3564516099__temp" (base.py:1822)
2024-05-28 15:15:48,809 - MainThread - sqlmesh.core.state_sync.common - INFO - Finalizing environment 'dev' (common.py:198)
2024-05-28 15:15:48,833 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
