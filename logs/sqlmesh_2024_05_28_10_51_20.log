2024-05-28 10:51:20,909 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'data/catalog.db'} (connection.py:255)
2024-05-28 10:51:21,611 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:257)
2024-05-28 10:51:21,669 - MainThread - sqlmesh.core.renderer - WARNING - Column '"codigo_regiao"' could not be resolved for model '"catalog"."dtb"."territorio"', the column may not exist or is ambiguous (renderer.py:528)
2024-05-28 10:51:21,672 - MainThread - sqlmesh.core.renderer - WARNING - Column '"idCompra"' could not be resolved for model '"catalog"."siasg"."compras"', the column may not exist or is ambiguous (renderer.py:528)
2024-05-28 10:51:21,674 - MainThread - sqlmesh.core.renderer - WARNING - Column '"codigoGrupo"' could not be resolved for model '"catalog"."siasg"."materiais"', the column may not exist or is ambiguous (renderer.py:528)
2024-05-28 10:51:21,676 - MainThread - sqlmesh.core.renderer - WARNING - Column '"codigoUasg"' could not be resolved for model '"catalog"."siasg"."uasgs"', the column may not exist or is ambiguous (renderer.py:528)
2024-05-28 10:51:21,678 - MainThread - sqlmesh.core.renderer - WARNING - Column '"codigoPdm"' could not be resolved for model '"catalog"."siasg"."unidades"', the column may not exist or is ambiguous (renderer.py:528)
2024-05-28 10:51:21,697 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: data/catalog.db (connection.py:250)
2024-05-28 10:51:21,712 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0001_init' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0001_init.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,714 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0002_remove_identify' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0002_remove_identify.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,714 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0003_move_batch_size' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0003_move_batch_size.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,714 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0004_environmnent_add_finalized_at' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0004_environmnent_add_finalized_at.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,715 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0005_create_seed_table' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0005_create_seed_table.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,715 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0006_change_seed_hash' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0006_change_seed_hash.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,715 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0007_env_table_info_to_kind' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0007_env_table_info_to_kind.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,716 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0008_create_intervals_table' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0008_create_intervals_table.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,716 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0009_remove_pre_post_hooks' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0009_remove_pre_post_hooks.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,717 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0010_seed_hash_batch_size' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0010_seed_hash_batch_size.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,717 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0011_add_model_kind_name' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0011_add_model_kind_name.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,717 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0012_update_jinja_expressions' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0012_update_jinja_expressions.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,718 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0013_serde_using_model_dialects' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0013_serde_using_model_dialects.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,718 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0014_fix_dev_intervals' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0014_fix_dev_intervals.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,718 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0015_environment_add_promoted_snapshot_ids' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0015_environment_add_promoted_snapshot_ids.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,719 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0016_fix_windows_path' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0016_fix_windows_path.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,719 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0017_fix_windows_seed_path' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0017_fix_windows_seed_path.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,719 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0018_rename_snapshot_model_to_node' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0018_rename_snapshot_model_to_node.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,720 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0019_add_env_suffix_target' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0019_add_env_suffix_target.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,720 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0020_remove_redundant_attributes_from_dbt_models' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0020_remove_redundant_attributes_from_dbt_models.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,720 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0021_fix_table_properties' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0021_fix_table_properties.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,721 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0022_move_project_to_model' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0022_move_project_to_model.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,721 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0023_fix_added_models_with_forward_only_parents' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0023_fix_added_models_with_forward_only_parents.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,722 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0024_replace_model_kind_name_enum_with_value' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0024_replace_model_kind_name_enum_with_value.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,722 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0025_fix_intervals_and_missing_change_category' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0025_fix_intervals_and_missing_change_category.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,722 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0026_remove_dialect_from_seed' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0026_remove_dialect_from_seed.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,723 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0027_minute_interval_to_five' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0027_minute_interval_to_five.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,723 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0028_add_plan_dags_table' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0028_add_plan_dags_table.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,724 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0029_generate_schema_types_using_dialect' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0029_generate_schema_types_using_dialect.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,724 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0030_update_unrestorable_snapshots' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0030_update_unrestorable_snapshots.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,724 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0031_remove_dbt_target_fields' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0031_remove_dbt_target_fields.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,725 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0032_add_sqlmesh_version' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0032_add_sqlmesh_version.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,725 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0033_mysql_fix_blob_text_type' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0033_mysql_fix_blob_text_type.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,725 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0034_add_default_catalog' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0034_add_default_catalog.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,727 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0035_add_catalog_name_override' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0035_add_catalog_name_override.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,727 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0036_delete_plan_dags_bug_fix' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0036_delete_plan_dags_bug_fix.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,727 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0037_remove_dbt_is_incremental_macro' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0037_remove_dbt_is_incremental_macro.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,727 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0038_add_expiration_ts_to_snapshot' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0038_add_expiration_ts_to_snapshot.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,728 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0039_include_environment_in_plan_dag_spec' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0039_include_environment_in_plan_dag_spec.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,728 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0040_add_previous_finalized_snapshots' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0040_add_previous_finalized_snapshots.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,730 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0041_remove_hash_raw_query_attribute' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0041_remove_hash_raw_query_attribute.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,730 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0042_trim_indirect_versions' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0042_trim_indirect_versions.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,731 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0043_fix_remove_obsolete_attributes_in_plan_dags' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0043_fix_remove_obsolete_attributes_in_plan_dags.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,731 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0044_quote_identifiers_in_model_attributes' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0044_quote_identifiers_in_model_attributes.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,731 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0045_move_gateway_variable' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0045_move_gateway_variable.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,731 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0046_add_batch_concurrency' from '/opt/homebrew/lib/python3.11/site-packages/sqlmesh/migrations/v0046_add_batch_concurrency.py'> (engine_adapter.py:915)
2024-05-28 10:51:21,731 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Fetching environments (engine_adapter.py:974)
2024-05-28 10:51:21,732 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Migrating snapshot rows... (engine_adapter.py:992)
2024-05-28 10:51:21,732 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - No changes to snapshots detected (engine_adapter.py:984)
2024-05-28 10:51:24,273 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema catalog.sqlmesh__dtb (evaluator.py:259)
2024-05-28 10:51:24,273 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1783)
2024-05-28 10:51:24,274 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1783)
2024-05-28 10:51:24,275 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__dtb' AND table_name IN ('dtb__territorio__3564516099', 'dtb__territorio__3564516099__temp') (base.py:1783)
2024-05-28 10:51:24,280 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema catalog.sqlmesh__bps (evaluator.py:259)
2024-05-28 10:51:24,280 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1783)
2024-05-28 10:51:24,281 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1783)
2024-05-28 10:51:24,282 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__bps' AND table_name IN ('bps__materiais__4088563816', 'bps__compras__3689629057__temp', 'bps__materiais__4088563816__temp', 'bps__unidades__3794497381__temp', 'bps__unidades__3794497381', 'bps__compras__3689629057') (base.py:1783)
2024-05-28 10:51:24,286 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema catalog.sqlmesh__siasg (evaluator.py:259)
2024-05-28 10:51:24,287 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1783)
2024-05-28 10:51:24,287 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1783)
2024-05-28 10:51:24,288 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__siasg' AND table_name IN ('siasg__unidades__3458370508', 'siasg__uasgs__3746688468', 'siasg__compras__1111392831', 'siasg__uasgs__3746688468__temp', 'siasg__materiais__382104304__temp', 'siasg__compras__1111392831__temp', 'siasg__unidades__3458370508__temp', 'siasg__materiais__382104304') (base.py:1783)
2024-05-28 10:51:24,292 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'catalog.sqlmesh__bps' (evaluator.py:810)
2024-05-28 10:51:24,293 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "catalog"."sqlmesh__bps" (base.py:1783)
2024-05-28 10:51:24,293 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'catalog.sqlmesh__siasg' (evaluator.py:810)
2024-05-28 10:51:24,293 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "catalog"."sqlmesh__siasg" (base.py:1783)
2024-05-28 10:51:24,293 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'catalog.sqlmesh__dtb' (evaluator.py:810)
2024-05-28 10:51:24,293 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "catalog"."sqlmesh__dtb" (base.py:1783)
2024-05-28 10:51:24,297 - MainThread - sqlmesh.core.renderer - WARNING - Column '"codigo_regiao"' could not be resolved for model '"catalog"."dtb"."territorio"', the column may not exist or is ambiguous (renderer.py:528)
2024-05-28 10:51:24,299 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__dtb.dtb__territorio__3564516099__temp' (evaluator.py:1105)
2024-05-28 10:51:24,299 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__dtb"."dtb__territorio__3564516099__temp" AS SELECT "codigo_regiao" AS "codigo_regiao", "nome_regiao" AS "nome_regiao", "codigo_uf" AS "codigo_uf", "sigla_uf" AS "sigla_uf", "nome_uf" AS "nome_uf", "codigo_regiao_geografica_intermediaria" AS "codigo_regiao_geografica_intermediaria", "regiao_geografica_intermediaria" AS "regiao_geografica_intermediaria", "codigo_regiao_geografica_imediata" AS "codigo_regiao_geografica_imediata", "regiao_geografica_imediata" AS "regiao_geografica_imediata", "codigo_mesorregiao" AS "codigo_mesorregiao", "nome_mesoregiao" AS "nome_mesoregiao", "codigo_microrregiao" AS "codigo_microrregiao", "nome_microrregiao" AS "nome_microrregiao", "codigo_municipio_5" AS "codigo_municipio_5", "codigo_municipio_6" AS "codigo_municipio_6", "codigo_municipio_7" AS "codigo_municipio_7", "nome_municipio" AS "nome_municipio" FROM READ_PARQUET('seeds/ibge.parquet') AS "_q_0" WHERE FALSE LIMIT 0 (base.py:1783)
2024-05-28 10:51:24,302 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__dtb.dtb__territorio__3564516099' (evaluator.py:1105)
2024-05-28 10:51:24,304 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__dtb"."dtb__territorio__3564516099" AS SELECT "codigo_regiao" AS "codigo_regiao", "nome_regiao" AS "nome_regiao", "codigo_uf" AS "codigo_uf", "sigla_uf" AS "sigla_uf", "nome_uf" AS "nome_uf", "codigo_regiao_geografica_intermediaria" AS "codigo_regiao_geografica_intermediaria", "regiao_geografica_intermediaria" AS "regiao_geografica_intermediaria", "codigo_regiao_geografica_imediata" AS "codigo_regiao_geografica_imediata", "regiao_geografica_imediata" AS "regiao_geografica_imediata", "codigo_mesorregiao" AS "codigo_mesorregiao", "nome_mesoregiao" AS "nome_mesoregiao", "codigo_microrregiao" AS "codigo_microrregiao", "nome_microrregiao" AS "nome_microrregiao", "codigo_municipio_5" AS "codigo_municipio_5", "codigo_municipio_6" AS "codigo_municipio_6", "codigo_municipio_7" AS "codigo_municipio_7", "nome_municipio" AS "nome_municipio" FROM READ_PARQUET('seeds/ibge.parquet') AS "_q_0" WHERE FALSE LIMIT 0 (base.py:1783)
2024-05-28 10:51:24,310 - MainThread - sqlmesh.core.renderer - WARNING - Column '"idCompra"' could not be resolved for model '"catalog"."siasg"."compras"', the column may not exist or is ambiguous (renderer.py:528)
2024-05-28 10:51:24,312 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__siasg.siasg__compras__1111392831__temp' (evaluator.py:1105)
2024-05-28 10:51:24,313 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__siasg"."siasg__compras__1111392831__temp" AS SELECT DISTINCT "idCompra" AS "idCompra", "idItemCompra" AS "idItemCompra", "forma" AS "forma", "modalidade" AS "modalidade", "criterioJulgamento" AS "criterioJulgamento", "numeroItemCompra" AS "numeroItemCompra", "descricaoItem" AS "descricaoItem", "codigoItemCatalogo" AS "codigoItemCatalogo", "nomeUnidadeMedida" AS "nomeUnidadeMedida", "siglaUnidadeMedida" AS "siglaUnidadeMedida", "nomeUnidadeFornecimento" AS "nomeUnidadeFornecimento", "siglaUnidadeFornecimento" AS "siglaUnidadeFornecimento", "capacidadeUnidadeFornecimento" AS "capacidadeUnidadeFornecimento", "quantidade" AS "quantidade", "precoUnitario" AS "precoUnitario", "percentualMaiorDesconto" AS "percentualMaiorDesconto", "niFornecedor" AS "niFornecedor", "nomeFornecedor" AS "nomeFornecedor", "marca" AS "marca", "codigoUasg" AS "codigoUasg", "nomeUasg" AS "nomeUasg", "codigoMunicipio" AS "codigoMunicipio", "municipio" AS "municipio", "estado" AS "estado", "codigoOrgao" AS "codigoOrgao", "nomeOrgao" AS "nomeOrgao", "poder" AS "poder", "esfera" AS "esfera", "dataCompra" AS "dataCompra", "dataHoraAtualizacaoCompra" AS "dataHoraAtualizacaoCompra", "dataHoraAtualizacaoItem" AS "dataHoraAtualizacaoItem", "dataResultado" AS "dataResultado", "dataHoraAtualizacaoUasg" AS "dataHoraAtualizacaoUasg" FROM READ_PARQUET('seeds/compras.parquet') AS "_q_0" WHERE FALSE LIMIT 0 (base.py:1783)
2024-05-28 10:51:24,317 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__siasg.siasg__compras__1111392831' (evaluator.py:1105)
2024-05-28 10:51:24,318 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__siasg"."siasg__compras__1111392831" AS SELECT DISTINCT "idCompra" AS "idCompra", "idItemCompra" AS "idItemCompra", "forma" AS "forma", "modalidade" AS "modalidade", "criterioJulgamento" AS "criterioJulgamento", "numeroItemCompra" AS "numeroItemCompra", "descricaoItem" AS "descricaoItem", "codigoItemCatalogo" AS "codigoItemCatalogo", "nomeUnidadeMedida" AS "nomeUnidadeMedida", "siglaUnidadeMedida" AS "siglaUnidadeMedida", "nomeUnidadeFornecimento" AS "nomeUnidadeFornecimento", "siglaUnidadeFornecimento" AS "siglaUnidadeFornecimento", "capacidadeUnidadeFornecimento" AS "capacidadeUnidadeFornecimento", "quantidade" AS "quantidade", "precoUnitario" AS "precoUnitario", "percentualMaiorDesconto" AS "percentualMaiorDesconto", "niFornecedor" AS "niFornecedor", "nomeFornecedor" AS "nomeFornecedor", "marca" AS "marca", "codigoUasg" AS "codigoUasg", "nomeUasg" AS "nomeUasg", "codigoMunicipio" AS "codigoMunicipio", "municipio" AS "municipio", "estado" AS "estado", "codigoOrgao" AS "codigoOrgao", "nomeOrgao" AS "nomeOrgao", "poder" AS "poder", "esfera" AS "esfera", "dataCompra" AS "dataCompra", "dataHoraAtualizacaoCompra" AS "dataHoraAtualizacaoCompra", "dataHoraAtualizacaoItem" AS "dataHoraAtualizacaoItem", "dataResultado" AS "dataResultado", "dataHoraAtualizacaoUasg" AS "dataHoraAtualizacaoUasg" FROM READ_PARQUET('seeds/compras.parquet') AS "_q_0" WHERE FALSE LIMIT 0 (base.py:1783)
2024-05-28 10:51:24,321 - MainThread - sqlmesh.core.renderer - WARNING - Column '"codigoGrupo"' could not be resolved for model '"catalog"."siasg"."materiais"', the column may not exist or is ambiguous (renderer.py:528)
2024-05-28 10:51:24,323 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__siasg.siasg__materiais__382104304__temp' (evaluator.py:1105)
2024-05-28 10:51:24,323 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__siasg"."siasg__materiais__382104304__temp" AS SELECT "codigoGrupo" AS "codigoGrupo", "nomeGrupo" AS "nomeGrupo", "codigoClasse" AS "codigoClasse", "nomeClasse" AS "nomeClasse", "codigoPdm" AS "codigoPdm", "nomePdm" AS "nomePdm", "codigoItem" AS "codigoItem", "descricaoItem" AS "descricaoItem", "statusItem" AS "statusItem", "itemSustentavel" AS "itemSustentavel", "dataHoraAtualizacao" AS "dataHoraAtualizacao" FROM READ_JSON_AUTO('seeds/materiais/**/record*.json', "format" = 'array', "hive_partitioning" = TRUE) AS "_q_0" WHERE FALSE LIMIT 0 (base.py:1783)
2024-05-28 10:51:24,831 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__siasg.siasg__materiais__382104304' (evaluator.py:1105)
2024-05-28 10:51:24,833 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__siasg"."siasg__materiais__382104304" AS SELECT "codigoGrupo" AS "codigoGrupo", "nomeGrupo" AS "nomeGrupo", "codigoClasse" AS "codigoClasse", "nomeClasse" AS "nomeClasse", "codigoPdm" AS "codigoPdm", "nomePdm" AS "nomePdm", "codigoItem" AS "codigoItem", "descricaoItem" AS "descricaoItem", "statusItem" AS "statusItem", "itemSustentavel" AS "itemSustentavel", "dataHoraAtualizacao" AS "dataHoraAtualizacao" FROM READ_JSON_AUTO('seeds/materiais/**/record*.json', "format" = 'array', "hive_partitioning" = TRUE) AS "_q_0" WHERE FALSE LIMIT 0 (base.py:1783)
2024-05-28 10:51:25,157 - MainThread - sqlmesh.core.renderer - WARNING - Column '"codigoUasg"' could not be resolved for model '"catalog"."siasg"."uasgs"', the column may not exist or is ambiguous (renderer.py:528)
2024-05-28 10:51:25,158 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__siasg.siasg__uasgs__3746688468__temp' (evaluator.py:1105)
2024-05-28 10:51:25,158 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__siasg"."siasg__uasgs__3746688468__temp" AS SELECT DISTINCT "codigoUasg" AS "codigoUasg", "nomeUasg" AS "nomeUasg", "usoSisg" AS "usoSisg", "adesaoSiasg" AS "adesaoSiasg", "siglaUf" AS "siglaUf", "codigoMunicipio" AS "codigoMunicipio", "codigoMunicipioIbge" AS "codigoMunicipioIbge", "nomeMunicipioIbge" AS "nomeMunicipioIbge", "cnpjCpfUasg" AS "cnpjCpfUasg", "codigoOrgao" AS "codigoOrgao", "cnpjCpfOrgao" AS "cnpjCpfOrgao", "cnpjCpfOrgaoVinculado" AS "cnpjCpfOrgaoVinculado", "cnpjCpfOrgaoSuperior" AS "cnpjCpfOrgaoSuperior", "codigoSiorg" AS "codigoSiorg", "statusUasg" AS "statusUasg", "dataImplantacaoSidec" AS "dataImplantacaoSidec", "dataHoraMovimento" AS "dataHoraMovimento" FROM READ_JSON_AUTO('seeds/uasgs/*.json') AS "_q_0" WHERE FALSE LIMIT 0 (base.py:1783)
2024-05-28 10:51:25,234 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__siasg.siasg__uasgs__3746688468' (evaluator.py:1105)
2024-05-28 10:51:25,234 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__siasg"."siasg__uasgs__3746688468" AS SELECT DISTINCT "codigoUasg" AS "codigoUasg", "nomeUasg" AS "nomeUasg", "usoSisg" AS "usoSisg", "adesaoSiasg" AS "adesaoSiasg", "siglaUf" AS "siglaUf", "codigoMunicipio" AS "codigoMunicipio", "codigoMunicipioIbge" AS "codigoMunicipioIbge", "nomeMunicipioIbge" AS "nomeMunicipioIbge", "cnpjCpfUasg" AS "cnpjCpfUasg", "codigoOrgao" AS "codigoOrgao", "cnpjCpfOrgao" AS "cnpjCpfOrgao", "cnpjCpfOrgaoVinculado" AS "cnpjCpfOrgaoVinculado", "cnpjCpfOrgaoSuperior" AS "cnpjCpfOrgaoSuperior", "codigoSiorg" AS "codigoSiorg", "statusUasg" AS "statusUasg", "dataImplantacaoSidec" AS "dataImplantacaoSidec", "dataHoraMovimento" AS "dataHoraMovimento" FROM READ_JSON_AUTO('seeds/uasgs/*.json') AS "_q_0" WHERE FALSE LIMIT 0 (base.py:1783)
2024-05-28 10:51:25,299 - MainThread - sqlmesh.core.renderer - WARNING - Column '"codigoPdm"' could not be resolved for model '"catalog"."siasg"."unidades"', the column may not exist or is ambiguous (renderer.py:528)
2024-05-28 10:51:25,299 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__siasg.siasg__unidades__3458370508__temp' (evaluator.py:1105)
2024-05-28 10:51:25,300 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__siasg"."siasg__unidades__3458370508__temp" AS SELECT DISTINCT "codigoPdm" AS "codigoPdm", "siglaUnidadeFornecimento" AS "siglaUnidadeFornecimento", "nomeUnidadeFornecimento" AS "nomeUnidadeFornecimento", "descricaoUnidadeFornecimento" AS "descricaoUnidadeFornecimento", "siglaUnidadeMedida" AS "siglaUnidadeMedida", "capacidadeUnidadeFornecimento" AS "capacidadeUnidadeFornecimento", "numeroSequencialUnidadeFornecimento" AS "numeroSequencialUnidadeFornecimento", "statusUnidadeFornecimentoPdm" AS "statusUnidadeFornecimentoPdm", "dataHoraAtualizacao" AS "dataHoraAtualizacao" FROM READ_JSON_AUTO('seeds/materiais/unidades/**/page*.json') AS "_q_0" WHERE FALSE LIMIT 0 (base.py:1783)
2024-05-28 10:51:25,703 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__siasg.siasg__unidades__3458370508' (evaluator.py:1105)
2024-05-28 10:51:25,704 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__siasg"."siasg__unidades__3458370508" AS SELECT DISTINCT "codigoPdm" AS "codigoPdm", "siglaUnidadeFornecimento" AS "siglaUnidadeFornecimento", "nomeUnidadeFornecimento" AS "nomeUnidadeFornecimento", "descricaoUnidadeFornecimento" AS "descricaoUnidadeFornecimento", "siglaUnidadeMedida" AS "siglaUnidadeMedida", "capacidadeUnidadeFornecimento" AS "capacidadeUnidadeFornecimento", "numeroSequencialUnidadeFornecimento" AS "numeroSequencialUnidadeFornecimento", "statusUnidadeFornecimentoPdm" AS "statusUnidadeFornecimentoPdm", "dataHoraAtualizacao" AS "dataHoraAtualizacao" FROM READ_JSON_AUTO('seeds/materiais/unidades/**/page*.json') AS "_q_0" WHERE FALSE LIMIT 0 (base.py:1783)
2024-05-28 10:51:26,108 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__bps.bps__materiais__4088563816__temp' (evaluator.py:1105)
2024-05-28 10:51:26,109 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__bps"."bps__materiais__4088563816__temp" AS SELECT "materiais"."codigoItem" AS "codigo_item_catalogo", "materiais"."descricaoItem" AS "descricao_item", "materiais"."statusItem" AS "status_ativo", "materiais"."codigoPdm" AS "codigo_pdm", "materiais"."nomePdm" AS "pdm", "materiais"."codigoGrupo" AS "codigo_grupo", "materiais"."nomeGrupo" AS "grupo", "materiais"."codigoClasse" AS "codigo_classe", "materiais"."nomeClasse" AS "classe", "materiais"."itemSustentavel" AS "item_sustentavel", "materiais"."dataHoraAtualizacao" AS "atualizado_em" FROM "catalog"."sqlmesh__siasg"."siasg__materiais__382104304" AS "materiais" WHERE FALSE LIMIT 0 (base.py:1783)
2024-05-28 10:51:26,110 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__bps.bps__materiais__4088563816' (evaluator.py:1105)
2024-05-28 10:51:26,111 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__bps"."bps__materiais__4088563816" AS SELECT "materiais"."codigoItem" AS "codigo_item_catalogo", "materiais"."descricaoItem" AS "descricao_item", "materiais"."statusItem" AS "status_ativo", "materiais"."codigoPdm" AS "codigo_pdm", "materiais"."nomePdm" AS "pdm", "materiais"."codigoGrupo" AS "codigo_grupo", "materiais"."nomeGrupo" AS "grupo", "materiais"."codigoClasse" AS "codigo_classe", "materiais"."nomeClasse" AS "classe", "materiais"."itemSustentavel" AS "item_sustentavel", "materiais"."dataHoraAtualizacao" AS "atualizado_em" FROM "catalog"."sqlmesh__siasg"."siasg__materiais__382104304" AS "materiais" WHERE FALSE LIMIT 0 (base.py:1783)
2024-05-28 10:51:26,118 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__bps.bps__unidades__3794497381__temp' (evaluator.py:1105)
2024-05-28 10:51:26,119 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__bps"."bps__unidades__3794497381__temp" AS SELECT MD5(CONCAT("_q_0"."codigoPdm", ';', "_q_0"."siglaUnidadeFornecimento", ';', "_q_0"."siglaUnidadeMedida", ';', "_q_0"."capacidadeUnidadeFornecimento")) AS "codigo_unidade_fornecimento", "_q_0"."codigoPdm" AS "codigo_pdm", LOWER("_q_0"."siglaUnidadeFornecimento") AS "sigla_tipo_unidade_fornecimento", UPPER("_q_0"."nomeUnidadeFornecimento") AS "tipo_unidade_fornecimento", LOWER("_q_0"."siglaUnidadeMedida") AS "unidade_medida", "_q_0"."capacidadeUnidadeFornecimento" AS "capacidade_unidade_fornecimento", UPPER("_q_0"."descricaoUnidadeFornecimento") AS "descricao_unidade_fornecimento" FROM (SELECT "unidades"."codigoPdm" AS "codigoPdm", "unidades"."siglaUnidadeFornecimento" AS "siglaUnidadeFornecimento", "unidades"."nomeUnidadeFornecimento" AS "nomeUnidadeFornecimento", "unidades"."descricaoUnidadeFornecimento" AS "descricaoUnidadeFornecimento", "unidades"."siglaUnidadeMedida" AS "siglaUnidadeMedida", "unidades"."capacidadeUnidadeFornecimento" AS "capacidadeUnidadeFornecimento", "unidades"."numeroSequencialUnidadeFornecimento" AS "numeroSequencialUnidadeFornecimento", "unidades"."statusUnidadeFornecimentoPdm" AS "statusUnidadeFornecimentoPdm", "unidades"."dataHoraAtualizacao" AS "dataHoraAtualizacao", ROW_NUMBER() OVER (PARTITION BY "unidades"."codigoPdm", "unidades"."siglaUnidadeFornecimento", "unidades"."siglaUnidadeMedida", "unidades"."capacidadeUnidadeFornecimento", "unidades"."statusUnidadeFornecimentoPdm" ORDER BY "unidades"."dataHoraAtualizacao" DESC) AS "rn" FROM "catalog"."sqlmesh__siasg"."siasg__unidades__3458370508" AS "unidades" WHERE FALSE LIMIT 0) AS "_q_0" WHERE ("_q_0"."rn" = 1 AND "_q_0"."statusUnidadeFornecimentoPdm" IS TRUE) AND FALSE ORDER BY "_q_0"."codigoPdm", "_q_0"."siglaUnidadeFornecimento", "_q_0"."siglaUnidadeMedida", "_q_0"."capacidadeUnidadeFornecimento" LIMIT 0 (base.py:1783)
2024-05-28 10:51:26,122 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__bps.bps__unidades__3794497381' (evaluator.py:1105)
2024-05-28 10:51:26,123 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__bps"."bps__unidades__3794497381" AS SELECT MD5(CONCAT("_q_0"."codigoPdm", ';', "_q_0"."siglaUnidadeFornecimento", ';', "_q_0"."siglaUnidadeMedida", ';', "_q_0"."capacidadeUnidadeFornecimento")) AS "codigo_unidade_fornecimento", "_q_0"."codigoPdm" AS "codigo_pdm", LOWER("_q_0"."siglaUnidadeFornecimento") AS "sigla_tipo_unidade_fornecimento", UPPER("_q_0"."nomeUnidadeFornecimento") AS "tipo_unidade_fornecimento", LOWER("_q_0"."siglaUnidadeMedida") AS "unidade_medida", "_q_0"."capacidadeUnidadeFornecimento" AS "capacidade_unidade_fornecimento", UPPER("_q_0"."descricaoUnidadeFornecimento") AS "descricao_unidade_fornecimento" FROM (SELECT "unidades"."codigoPdm" AS "codigoPdm", "unidades"."siglaUnidadeFornecimento" AS "siglaUnidadeFornecimento", "unidades"."nomeUnidadeFornecimento" AS "nomeUnidadeFornecimento", "unidades"."descricaoUnidadeFornecimento" AS "descricaoUnidadeFornecimento", "unidades"."siglaUnidadeMedida" AS "siglaUnidadeMedida", "unidades"."capacidadeUnidadeFornecimento" AS "capacidadeUnidadeFornecimento", "unidades"."numeroSequencialUnidadeFornecimento" AS "numeroSequencialUnidadeFornecimento", "unidades"."statusUnidadeFornecimentoPdm" AS "statusUnidadeFornecimentoPdm", "unidades"."dataHoraAtualizacao" AS "dataHoraAtualizacao", ROW_NUMBER() OVER (PARTITION BY "unidades"."codigoPdm", "unidades"."siglaUnidadeFornecimento", "unidades"."siglaUnidadeMedida", "unidades"."capacidadeUnidadeFornecimento", "unidades"."statusUnidadeFornecimentoPdm" ORDER BY "unidades"."dataHoraAtualizacao" DESC) AS "rn" FROM "catalog"."sqlmesh__siasg"."siasg__unidades__3458370508" AS "unidades" WHERE FALSE LIMIT 0) AS "_q_0" WHERE ("_q_0"."rn" = 1 AND "_q_0"."statusUnidadeFornecimentoPdm" IS TRUE) AND FALSE ORDER BY "_q_0"."codigoPdm", "_q_0"."siglaUnidadeFornecimento", "_q_0"."siglaUnidadeMedida", "_q_0"."capacidadeUnidadeFornecimento" LIMIT 0 (base.py:1783)
2024-05-28 10:51:26,134 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__bps.bps__compras__3689629057__temp' (evaluator.py:1105)
2024-05-28 10:51:26,136 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__bps"."bps__compras__3689629057__temp" AS SELECT CAST("_q_0"."data_compra" AS DATE) AS "data_compra", "_q_0"."codigo_compra" AS "codigo_compra", "_q_0"."codigo_item_compra" AS "codigo_item_compra", "_q_0"."codigo_item_catalogo" AS "codigo_item_catalogo", MD5(CONCAT("_q_0"."codigo_pdm", ';', "_q_0"."sigla_tipo_unidade_fornecimento", ';', "_q_0"."unidade_medida", ';', "_q_0"."capacidade_unidade_fornecimento")) AS "codigo_unidade_fornecimento", "_q_0"."codigo_uasg" AS "codigo_uasg", "_q_0"."cnpj_fornecedor" AS "cnpj_fornecedor", "_q_0"."fornecedor" AS "fornecedor", "_q_0"."marca_fabricante" AS "marca_fabricante", "_q_0"."quantidade" AS "quantidade", CAST("_q_0"."preco_unitario" AS DECIMAL(18, 2)) AS "preco_unitario" FROM (SELECT DISTINCT "c"."codigo_compra" AS "codigo_compra", "c"."codigo_item_compra" AS "codigo_item_compra", "c"."codigo_item_catalogo" AS "codigo_item_catalogo", "c"."sigla_tipo_unidade_fornecimento" AS "sigla_tipo_unidade_fornecimento", "c"."tipo_unidade_fornecimento" AS "tipo_unidade_fornecimento", "c"."unidade_medida" AS "unidade_medida", "c"."capacidade_unidade_fornecimento" AS "capacidade_unidade_fornecimento", "c"."quantidade" AS "quantidade", "c"."preco_unitario" AS "preco_unitario", "c"."cnpj_fornecedor" AS "cnpj_fornecedor", "c"."fornecedor" AS "fornecedor", "c"."marca_fabricante" AS "marca_fabricante", "c"."codigo_uasg" AS "codigo_uasg", "c"."data_compra" AS "data_compra", "m"."codigo_pdm" AS "codigo_pdm", "m"."descricao_item" AS "descricao_item" FROM (SELECT "compras"."idCompra" AS "codigo_compra", "compras"."idItemCompra" AS "codigo_item_compra", "compras"."codigoItemCatalogo" AS "codigo_item_catalogo", "compras"."siglaUnidadeFornecimento" AS "sigla_tipo_unidade_fornecimento", "compras"."nomeUnidadeFornecimento" AS "tipo_unidade_fornecimento", "compras"."siglaUnidadeMedida" AS "unidade_medida", "compras"."capacidadeUnidadeFornecimento" AS "capacidade_unidade_fornecimento", "compras"."quantidade" AS "quantidade", "compras"."precoUnitario" AS "preco_unitario", "compras"."niFornecedor" AS "cnpj_fornecedor", "compras"."nomeFornecedor" AS "fornecedor", "compras"."marca" AS "marca_fabricante", "compras"."codigoUasg" AS "codigo_uasg", "compras"."dataCompra" AS "data_compra" FROM "catalog"."sqlmesh__siasg"."siasg__compras__1111392831" AS "compras" WHERE FALSE LIMIT 0) AS "c" LEFT JOIN "catalog"."sqlmesh__bps"."bps__materiais__4088563816" AS "m" ON "c"."codigo_item_catalogo" = "m"."codigo_item_catalogo" WHERE FALSE LIMIT 0) AS "_q_0" WHERE FALSE ORDER BY "data_compra", "codigo_compra", "codigo_item_compra" LIMIT 0 (base.py:1783)
2024-05-28 10:51:26,140 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__bps.bps__compras__3689629057' (evaluator.py:1105)
2024-05-28 10:51:26,142 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__bps"."bps__compras__3689629057" AS SELECT CAST("_q_0"."data_compra" AS DATE) AS "data_compra", "_q_0"."codigo_compra" AS "codigo_compra", "_q_0"."codigo_item_compra" AS "codigo_item_compra", "_q_0"."codigo_item_catalogo" AS "codigo_item_catalogo", MD5(CONCAT("_q_0"."codigo_pdm", ';', "_q_0"."sigla_tipo_unidade_fornecimento", ';', "_q_0"."unidade_medida", ';', "_q_0"."capacidade_unidade_fornecimento")) AS "codigo_unidade_fornecimento", "_q_0"."codigo_uasg" AS "codigo_uasg", "_q_0"."cnpj_fornecedor" AS "cnpj_fornecedor", "_q_0"."fornecedor" AS "fornecedor", "_q_0"."marca_fabricante" AS "marca_fabricante", "_q_0"."quantidade" AS "quantidade", CAST("_q_0"."preco_unitario" AS DECIMAL(18, 2)) AS "preco_unitario" FROM (SELECT DISTINCT "c"."codigo_compra" AS "codigo_compra", "c"."codigo_item_compra" AS "codigo_item_compra", "c"."codigo_item_catalogo" AS "codigo_item_catalogo", "c"."sigla_tipo_unidade_fornecimento" AS "sigla_tipo_unidade_fornecimento", "c"."tipo_unidade_fornecimento" AS "tipo_unidade_fornecimento", "c"."unidade_medida" AS "unidade_medida", "c"."capacidade_unidade_fornecimento" AS "capacidade_unidade_fornecimento", "c"."quantidade" AS "quantidade", "c"."preco_unitario" AS "preco_unitario", "c"."cnpj_fornecedor" AS "cnpj_fornecedor", "c"."fornecedor" AS "fornecedor", "c"."marca_fabricante" AS "marca_fabricante", "c"."codigo_uasg" AS "codigo_uasg", "c"."data_compra" AS "data_compra", "m"."codigo_pdm" AS "codigo_pdm", "m"."descricao_item" AS "descricao_item" FROM (SELECT "compras"."idCompra" AS "codigo_compra", "compras"."idItemCompra" AS "codigo_item_compra", "compras"."codigoItemCatalogo" AS "codigo_item_catalogo", "compras"."siglaUnidadeFornecimento" AS "sigla_tipo_unidade_fornecimento", "compras"."nomeUnidadeFornecimento" AS "tipo_unidade_fornecimento", "compras"."siglaUnidadeMedida" AS "unidade_medida", "compras"."capacidadeUnidadeFornecimento" AS "capacidade_unidade_fornecimento", "compras"."quantidade" AS "quantidade", "compras"."precoUnitario" AS "preco_unitario", "compras"."niFornecedor" AS "cnpj_fornecedor", "compras"."nomeFornecedor" AS "fornecedor", "compras"."marca" AS "marca_fabricante", "compras"."codigoUasg" AS "codigo_uasg", "compras"."dataCompra" AS "data_compra" FROM "catalog"."sqlmesh__siasg"."siasg__compras__1111392831" AS "compras" WHERE FALSE LIMIT 0) AS "c" LEFT JOIN "catalog"."sqlmesh__bps"."bps__materiais__4088563816" AS "m" ON "c"."codigo_item_catalogo" = "m"."codigo_item_catalogo" WHERE FALSE LIMIT 0) AS "_q_0" WHERE FALSE ORDER BY "data_compra", "codigo_compra", "codigo_item_compra" LIMIT 0 (base.py:1783)
2024-05-28 10:51:26,163 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"catalog"."dtb"."territorio": 4040480099> (evaluator.py:465)
2024-05-28 10:51:26,165 - MainThread - sqlmesh.core.renderer - WARNING - Column '"codigo_regiao"' could not be resolved for model '"catalog"."dtb"."territorio"', the column may not exist or is ambiguous (renderer.py:528)
2024-05-28 10:51:26,166 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-05-27 00:00:00+00:00, 2024-05-28 00:00:00+00:00) into catalog.sqlmesh__dtb.dtb__territorio__3564516099' (evaluator.py:489)
2024-05-28 10:51:26,166 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "catalog"."sqlmesh__dtb"."dtb__territorio__3564516099" (base.py:1783)
2024-05-28 10:51:26,168 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "catalog"."sqlmesh__dtb"."dtb__territorio__3564516099" AS SELECT "codigo_regiao" AS "codigo_regiao", "nome_regiao" AS "nome_regiao", "codigo_uf" AS "codigo_uf", "sigla_uf" AS "sigla_uf", "nome_uf" AS "nome_uf", "codigo_regiao_geografica_intermediaria" AS "codigo_regiao_geografica_intermediaria", "regiao_geografica_intermediaria" AS "regiao_geografica_intermediaria", "codigo_regiao_geografica_imediata" AS "codigo_regiao_geografica_imediata", "regiao_geografica_imediata" AS "regiao_geografica_imediata", "codigo_mesorregiao" AS "codigo_mesorregiao", "nome_mesoregiao" AS "nome_mesoregiao", "codigo_microrregiao" AS "codigo_microrregiao", "nome_microrregiao" AS "nome_microrregiao", "codigo_municipio_5" AS "codigo_municipio_5", "codigo_municipio_6" AS "codigo_municipio_6", "codigo_municipio_7" AS "codigo_municipio_7", "nome_municipio" AS "nome_municipio" FROM READ_PARQUET('seeds/ibge.parquet') AS "_q_0" (base.py:1783)
2024-05-28 10:51:26,178 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1716768000000, 1716854400000) for snapshot SnapshotId<"catalog"."dtb"."territorio": 4040480099> (engine_adapter.py:627)
2024-05-28 10:51:26,184 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"catalog"."siasg"."compras": 1520849120> (evaluator.py:465)
2024-05-28 10:51:26,187 - MainThread - sqlmesh.core.renderer - WARNING - Column '"idCompra"' could not be resolved for model '"catalog"."siasg"."compras"', the column may not exist or is ambiguous (renderer.py:528)
2024-05-28 10:51:26,188 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-05-27 00:00:00+00:00, 2024-05-28 00:00:00+00:00) into catalog.sqlmesh__siasg.siasg__compras__1111392831' (evaluator.py:489)
2024-05-28 10:51:26,188 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "catalog"."sqlmesh__siasg"."siasg__compras__1111392831" (base.py:1783)
2024-05-28 10:51:26,191 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "catalog"."sqlmesh__siasg"."siasg__compras__1111392831" AS SELECT DISTINCT "idCompra" AS "idCompra", "idItemCompra" AS "idItemCompra", "forma" AS "forma", "modalidade" AS "modalidade", "criterioJulgamento" AS "criterioJulgamento", "numeroItemCompra" AS "numeroItemCompra", "descricaoItem" AS "descricaoItem", "codigoItemCatalogo" AS "codigoItemCatalogo", "nomeUnidadeMedida" AS "nomeUnidadeMedida", "siglaUnidadeMedida" AS "siglaUnidadeMedida", "nomeUnidadeFornecimento" AS "nomeUnidadeFornecimento", "siglaUnidadeFornecimento" AS "siglaUnidadeFornecimento", "capacidadeUnidadeFornecimento" AS "capacidadeUnidadeFornecimento", "quantidade" AS "quantidade", "precoUnitario" AS "precoUnitario", "percentualMaiorDesconto" AS "percentualMaiorDesconto", "niFornecedor" AS "niFornecedor", "nomeFornecedor" AS "nomeFornecedor", "marca" AS "marca", "codigoUasg" AS "codigoUasg", "nomeUasg" AS "nomeUasg", "codigoMunicipio" AS "codigoMunicipio", "municipio" AS "municipio", "estado" AS "estado", "codigoOrgao" AS "codigoOrgao", "nomeOrgao" AS "nomeOrgao", "poder" AS "poder", "esfera" AS "esfera", "dataCompra" AS "dataCompra", "dataHoraAtualizacaoCompra" AS "dataHoraAtualizacaoCompra", "dataHoraAtualizacaoItem" AS "dataHoraAtualizacaoItem", "dataResultado" AS "dataResultado", "dataHoraAtualizacaoUasg" AS "dataHoraAtualizacaoUasg" FROM READ_PARQUET('seeds/compras.parquet') AS "_q_0" (base.py:1783)
2024-05-28 10:51:28,385 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1716768000000, 1716854400000) for snapshot SnapshotId<"catalog"."siasg"."compras": 1520849120> (engine_adapter.py:627)
2024-05-28 10:51:28,390 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"catalog"."siasg"."materiais": 4008633460> (evaluator.py:465)
2024-05-28 10:51:28,392 - MainThread - sqlmesh.core.renderer - WARNING - Column '"codigoGrupo"' could not be resolved for model '"catalog"."siasg"."materiais"', the column may not exist or is ambiguous (renderer.py:528)
2024-05-28 10:51:28,393 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-05-27 00:00:00+00:00, 2024-05-28 00:00:00+00:00) into catalog.sqlmesh__siasg.siasg__materiais__382104304' (evaluator.py:489)
2024-05-28 10:51:28,393 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "catalog"."sqlmesh__siasg"."siasg__materiais__382104304" (base.py:1783)
2024-05-28 10:51:28,394 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "catalog"."sqlmesh__siasg"."siasg__materiais__382104304" AS SELECT "codigoGrupo" AS "codigoGrupo", "nomeGrupo" AS "nomeGrupo", "codigoClasse" AS "codigoClasse", "nomeClasse" AS "nomeClasse", "codigoPdm" AS "codigoPdm", "nomePdm" AS "nomePdm", "codigoItem" AS "codigoItem", "descricaoItem" AS "descricaoItem", "statusItem" AS "statusItem", "itemSustentavel" AS "itemSustentavel", "dataHoraAtualizacao" AS "dataHoraAtualizacao" FROM READ_JSON_AUTO('seeds/materiais/**/record*.json', "format" = 'array', "hive_partitioning" = TRUE) AS "_q_0" (base.py:1783)
2024-05-28 10:51:29,046 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1716768000000, 1716854400000) for snapshot SnapshotId<"catalog"."siasg"."materiais": 4008633460> (engine_adapter.py:627)
2024-05-28 10:51:29,057 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"catalog"."siasg"."uasgs": 93551257> (evaluator.py:465)
2024-05-28 10:51:29,059 - MainThread - sqlmesh.core.renderer - WARNING - Column '"codigoUasg"' could not be resolved for model '"catalog"."siasg"."uasgs"', the column may not exist or is ambiguous (renderer.py:528)
2024-05-28 10:51:29,060 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-05-27 00:00:00+00:00, 2024-05-28 00:00:00+00:00) into catalog.sqlmesh__siasg.siasg__uasgs__3746688468' (evaluator.py:489)
2024-05-28 10:51:29,060 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "catalog"."sqlmesh__siasg"."siasg__uasgs__3746688468" (base.py:1783)
2024-05-28 10:51:29,061 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "catalog"."sqlmesh__siasg"."siasg__uasgs__3746688468" AS SELECT DISTINCT "codigoUasg" AS "codigoUasg", "nomeUasg" AS "nomeUasg", "usoSisg" AS "usoSisg", "adesaoSiasg" AS "adesaoSiasg", "siglaUf" AS "siglaUf", "codigoMunicipio" AS "codigoMunicipio", "codigoMunicipioIbge" AS "codigoMunicipioIbge", "nomeMunicipioIbge" AS "nomeMunicipioIbge", "cnpjCpfUasg" AS "cnpjCpfUasg", "codigoOrgao" AS "codigoOrgao", "cnpjCpfOrgao" AS "cnpjCpfOrgao", "cnpjCpfOrgaoVinculado" AS "cnpjCpfOrgaoVinculado", "cnpjCpfOrgaoSuperior" AS "cnpjCpfOrgaoSuperior", "codigoSiorg" AS "codigoSiorg", "statusUasg" AS "statusUasg", "dataImplantacaoSidec" AS "dataImplantacaoSidec", "dataHoraMovimento" AS "dataHoraMovimento" FROM READ_JSON_AUTO('seeds/uasgs/*.json') AS "_q_0" (base.py:1783)
2024-05-28 10:51:29,156 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1716768000000, 1716854400000) for snapshot SnapshotId<"catalog"."siasg"."uasgs": 93551257> (engine_adapter.py:627)
2024-05-28 10:51:29,161 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"catalog"."siasg"."unidades": 22931269> (evaluator.py:465)
2024-05-28 10:51:29,162 - MainThread - sqlmesh.core.renderer - WARNING - Column '"codigoPdm"' could not be resolved for model '"catalog"."siasg"."unidades"', the column may not exist or is ambiguous (renderer.py:528)
2024-05-28 10:51:29,163 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-05-27 00:00:00+00:00, 2024-05-28 00:00:00+00:00) into catalog.sqlmesh__siasg.siasg__unidades__3458370508' (evaluator.py:489)
2024-05-28 10:51:29,163 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "catalog"."sqlmesh__siasg"."siasg__unidades__3458370508" (base.py:1783)
2024-05-28 10:51:29,164 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "catalog"."sqlmesh__siasg"."siasg__unidades__3458370508" AS SELECT DISTINCT "codigoPdm" AS "codigoPdm", "siglaUnidadeFornecimento" AS "siglaUnidadeFornecimento", "nomeUnidadeFornecimento" AS "nomeUnidadeFornecimento", "descricaoUnidadeFornecimento" AS "descricaoUnidadeFornecimento", "siglaUnidadeMedida" AS "siglaUnidadeMedida", "capacidadeUnidadeFornecimento" AS "capacidadeUnidadeFornecimento", "numeroSequencialUnidadeFornecimento" AS "numeroSequencialUnidadeFornecimento", "statusUnidadeFornecimentoPdm" AS "statusUnidadeFornecimentoPdm", "dataHoraAtualizacao" AS "dataHoraAtualizacao" FROM READ_JSON_AUTO('seeds/materiais/unidades/**/page*.json') AS "_q_0" (base.py:1783)
2024-05-28 10:51:30,735 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1716768000000, 1716854400000) for snapshot SnapshotId<"catalog"."siasg"."unidades": 22931269> (engine_adapter.py:627)
2024-05-28 10:51:30,739 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"catalog"."bps"."materiais": 4041260782> (evaluator.py:465)
2024-05-28 10:51:30,742 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-05-27 00:00:00+00:00, 2024-05-28 00:00:00+00:00) into catalog.sqlmesh__bps.bps__materiais__4088563816' (evaluator.py:489)
2024-05-28 10:51:30,743 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "catalog"."sqlmesh__bps"."bps__materiais__4088563816" (base.py:1783)
2024-05-28 10:51:30,744 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "catalog"."sqlmesh__bps"."bps__materiais__4088563816" AS SELECT "materiais"."codigoItem" AS "codigo_item_catalogo", "materiais"."descricaoItem" AS "descricao_item", "materiais"."statusItem" AS "status_ativo", "materiais"."codigoPdm" AS "codigo_pdm", "materiais"."nomePdm" AS "pdm", "materiais"."codigoGrupo" AS "codigo_grupo", "materiais"."nomeGrupo" AS "grupo", "materiais"."codigoClasse" AS "codigo_classe", "materiais"."nomeClasse" AS "classe", "materiais"."itemSustentavel" AS "item_sustentavel", "materiais"."dataHoraAtualizacao" AS "atualizado_em" FROM "catalog"."sqlmesh__siasg"."siasg__materiais__382104304" AS "materiais" (base.py:1783)
2024-05-28 10:51:30,992 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1716768000000, 1716854400000) for snapshot SnapshotId<"catalog"."bps"."materiais": 4041260782> (engine_adapter.py:627)
2024-05-28 10:51:30,997 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"catalog"."bps"."unidades": 1835510233> (evaluator.py:465)
2024-05-28 10:51:31,041 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-05-27 00:00:00+00:00, 2024-05-28 00:00:00+00:00) into catalog.sqlmesh__bps.bps__unidades__3794497381' (evaluator.py:489)
2024-05-28 10:51:31,042 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "catalog"."sqlmesh__bps"."bps__unidades__3794497381" (base.py:1783)
2024-05-28 10:51:31,044 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "catalog"."sqlmesh__bps"."bps__unidades__3794497381" AS SELECT MD5(CONCAT("_q_0"."codigoPdm", ';', "_q_0"."siglaUnidadeFornecimento", ';', "_q_0"."siglaUnidadeMedida", ';', "_q_0"."capacidadeUnidadeFornecimento")) AS "codigo_unidade_fornecimento", "_q_0"."codigoPdm" AS "codigo_pdm", LOWER("_q_0"."siglaUnidadeFornecimento") AS "sigla_tipo_unidade_fornecimento", UPPER("_q_0"."nomeUnidadeFornecimento") AS "tipo_unidade_fornecimento", LOWER("_q_0"."siglaUnidadeMedida") AS "unidade_medida", "_q_0"."capacidadeUnidadeFornecimento" AS "capacidade_unidade_fornecimento", UPPER("_q_0"."descricaoUnidadeFornecimento") AS "descricao_unidade_fornecimento" FROM (SELECT "unidades"."codigoPdm" AS "codigoPdm", "unidades"."siglaUnidadeFornecimento" AS "siglaUnidadeFornecimento", "unidades"."nomeUnidadeFornecimento" AS "nomeUnidadeFornecimento", "unidades"."descricaoUnidadeFornecimento" AS "descricaoUnidadeFornecimento", "unidades"."siglaUnidadeMedida" AS "siglaUnidadeMedida", "unidades"."capacidadeUnidadeFornecimento" AS "capacidadeUnidadeFornecimento", "unidades"."numeroSequencialUnidadeFornecimento" AS "numeroSequencialUnidadeFornecimento", "unidades"."statusUnidadeFornecimentoPdm" AS "statusUnidadeFornecimentoPdm", "unidades"."dataHoraAtualizacao" AS "dataHoraAtualizacao", ROW_NUMBER() OVER (PARTITION BY "unidades"."codigoPdm", "unidades"."siglaUnidadeFornecimento", "unidades"."siglaUnidadeMedida", "unidades"."capacidadeUnidadeFornecimento", "unidades"."statusUnidadeFornecimentoPdm" ORDER BY "unidades"."dataHoraAtualizacao" DESC) AS "rn" FROM "catalog"."sqlmesh__siasg"."siasg__unidades__3458370508" AS "unidades") AS "_q_0" WHERE "_q_0"."rn" = 1 AND "_q_0"."statusUnidadeFornecimentoPdm" IS TRUE ORDER BY "_q_0"."codigoPdm", "_q_0"."siglaUnidadeFornecimento", "_q_0"."siglaUnidadeMedida", "_q_0"."capacidadeUnidadeFornecimento" (base.py:1783)
2024-05-28 10:51:31,057 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1716768000000, 1716854400000) for snapshot SnapshotId<"catalog"."bps"."unidades": 1835510233> (engine_adapter.py:627)
2024-05-28 10:51:31,062 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"catalog"."bps"."compras": 477040649> (evaluator.py:465)
2024-05-28 10:51:31,071 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-05-27 00:00:00+00:00, 2024-05-28 00:00:00+00:00) into catalog.sqlmesh__bps.bps__compras__3689629057' (evaluator.py:489)
2024-05-28 10:51:31,071 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "catalog"."sqlmesh__bps"."bps__compras__3689629057" (base.py:1783)
2024-05-28 10:51:31,073 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "catalog"."sqlmesh__bps"."bps__compras__3689629057" AS SELECT CAST("_q_0"."data_compra" AS DATE) AS "data_compra", "_q_0"."codigo_compra" AS "codigo_compra", "_q_0"."codigo_item_compra" AS "codigo_item_compra", "_q_0"."codigo_item_catalogo" AS "codigo_item_catalogo", MD5(CONCAT("_q_0"."codigo_pdm", ';', "_q_0"."sigla_tipo_unidade_fornecimento", ';', "_q_0"."unidade_medida", ';', "_q_0"."capacidade_unidade_fornecimento")) AS "codigo_unidade_fornecimento", "_q_0"."codigo_uasg" AS "codigo_uasg", "_q_0"."cnpj_fornecedor" AS "cnpj_fornecedor", "_q_0"."fornecedor" AS "fornecedor", "_q_0"."marca_fabricante" AS "marca_fabricante", "_q_0"."quantidade" AS "quantidade", CAST("_q_0"."preco_unitario" AS DECIMAL(18, 2)) AS "preco_unitario" FROM (SELECT DISTINCT "c"."codigo_compra" AS "codigo_compra", "c"."codigo_item_compra" AS "codigo_item_compra", "c"."codigo_item_catalogo" AS "codigo_item_catalogo", "c"."sigla_tipo_unidade_fornecimento" AS "sigla_tipo_unidade_fornecimento", "c"."tipo_unidade_fornecimento" AS "tipo_unidade_fornecimento", "c"."unidade_medida" AS "unidade_medida", "c"."capacidade_unidade_fornecimento" AS "capacidade_unidade_fornecimento", "c"."quantidade" AS "quantidade", "c"."preco_unitario" AS "preco_unitario", "c"."cnpj_fornecedor" AS "cnpj_fornecedor", "c"."fornecedor" AS "fornecedor", "c"."marca_fabricante" AS "marca_fabricante", "c"."codigo_uasg" AS "codigo_uasg", "c"."data_compra" AS "data_compra", "m"."codigo_pdm" AS "codigo_pdm", "m"."descricao_item" AS "descricao_item" FROM (SELECT "compras"."idCompra" AS "codigo_compra", "compras"."idItemCompra" AS "codigo_item_compra", "compras"."codigoItemCatalogo" AS "codigo_item_catalogo", "compras"."siglaUnidadeFornecimento" AS "sigla_tipo_unidade_fornecimento", "compras"."nomeUnidadeFornecimento" AS "tipo_unidade_fornecimento", "compras"."siglaUnidadeMedida" AS "unidade_medida", "compras"."capacidadeUnidadeFornecimento" AS "capacidade_unidade_fornecimento", "compras"."quantidade" AS "quantidade", "compras"."precoUnitario" AS "preco_unitario", "compras"."niFornecedor" AS "cnpj_fornecedor", "compras"."nomeFornecedor" AS "fornecedor", "compras"."marca" AS "marca_fabricante", "compras"."codigoUasg" AS "codigo_uasg", "compras"."dataCompra" AS "data_compra" FROM "catalog"."sqlmesh__siasg"."siasg__compras__1111392831" AS "compras") AS "c" LEFT JOIN "catalog"."sqlmesh__bps"."bps__materiais__4088563816" AS "m" ON "c"."codigo_item_catalogo" = "m"."codigo_item_catalogo") AS "_q_0" ORDER BY "data_compra", "codigo_compra", "codigo_item_compra" (base.py:1783)
2024-05-28 10:51:31,804 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1716768000000, 1716854400000) for snapshot SnapshotId<"catalog"."bps"."compras": 477040649> (engine_adapter.py:627)
2024-05-28 10:51:31,811 - MainThread - sqlmesh.core.state_sync.common - INFO - Promoting environment 'prod' (common.py:120)
2024-05-28 10:51:31,830 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"catalog"."dtb"."territorio": 4040480099> (common.py:225)
2024-05-28 10:51:31,831 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"catalog"."bps"."unidades": 1835510233> (common.py:225)
2024-05-28 10:51:31,833 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"catalog"."bps"."compras": 477040649> (common.py:225)
2024-05-28 10:51:31,834 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"catalog"."bps"."materiais": 4041260782> (common.py:225)
2024-05-28 10:51:31,836 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"catalog"."siasg"."unidades": 22931269> (common.py:225)
2024-05-28 10:51:31,837 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"catalog"."siasg"."compras": 1520849120> (common.py:225)
2024-05-28 10:51:31,838 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"catalog"."siasg"."materiais": 4008633460> (common.py:225)
2024-05-28 10:51:31,839 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"catalog"."siasg"."uasgs": 93551257> (common.py:225)
2024-05-28 10:51:31,844 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'catalog.dtb' (evaluator.py:810)
2024-05-28 10:51:31,845 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "catalog"."dtb" (base.py:1783)
2024-05-28 10:51:31,845 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'catalog.bps' (evaluator.py:810)
2024-05-28 10:51:31,845 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "catalog"."bps" (base.py:1783)
2024-05-28 10:51:31,845 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'catalog.siasg' (evaluator.py:810)
2024-05-28 10:51:31,845 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "catalog"."siasg" (base.py:1783)
2024-05-28 10:51:31,845 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.dtb.territorio' to point at table 'catalog.sqlmesh__dtb.dtb__territorio__3564516099' (evaluator.py:1063)
2024-05-28 10:51:31,846 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."dtb"."territorio" AS SELECT * FROM "catalog"."sqlmesh__dtb"."dtb__territorio__3564516099" (base.py:1783)
2024-05-28 10:51:31,846 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.siasg.compras' to point at table 'catalog.sqlmesh__siasg.siasg__compras__1111392831' (evaluator.py:1063)
2024-05-28 10:51:31,847 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."siasg"."compras" AS SELECT * FROM "catalog"."sqlmesh__siasg"."siasg__compras__1111392831" (base.py:1783)
2024-05-28 10:51:31,847 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.siasg.materiais' to point at table 'catalog.sqlmesh__siasg.siasg__materiais__382104304' (evaluator.py:1063)
2024-05-28 10:51:31,848 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."siasg"."materiais" AS SELECT * FROM "catalog"."sqlmesh__siasg"."siasg__materiais__382104304" (base.py:1783)
2024-05-28 10:51:31,848 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.siasg.uasgs' to point at table 'catalog.sqlmesh__siasg.siasg__uasgs__3746688468' (evaluator.py:1063)
2024-05-28 10:51:31,848 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."siasg"."uasgs" AS SELECT * FROM "catalog"."sqlmesh__siasg"."siasg__uasgs__3746688468" (base.py:1783)
2024-05-28 10:51:31,849 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.siasg.unidades' to point at table 'catalog.sqlmesh__siasg.siasg__unidades__3458370508' (evaluator.py:1063)
2024-05-28 10:51:31,849 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."siasg"."unidades" AS SELECT * FROM "catalog"."sqlmesh__siasg"."siasg__unidades__3458370508" (base.py:1783)
2024-05-28 10:51:31,850 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.bps.materiais' to point at table 'catalog.sqlmesh__bps.bps__materiais__4088563816' (evaluator.py:1063)
2024-05-28 10:51:31,850 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."bps"."materiais" AS SELECT * FROM "catalog"."sqlmesh__bps"."bps__materiais__4088563816" (base.py:1783)
2024-05-28 10:51:31,851 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.bps.unidades' to point at table 'catalog.sqlmesh__bps.bps__unidades__3794497381' (evaluator.py:1063)
2024-05-28 10:51:31,852 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."bps"."unidades" AS SELECT * FROM "catalog"."sqlmesh__bps"."bps__unidades__3794497381" (base.py:1783)
2024-05-28 10:51:31,852 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.bps.compras' to point at table 'catalog.sqlmesh__bps.bps__compras__3689629057' (evaluator.py:1063)
2024-05-28 10:51:31,853 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."bps"."compras" AS SELECT * FROM "catalog"."sqlmesh__bps"."bps__compras__3689629057" (base.py:1783)
2024-05-28 10:51:31,853 - MainThread - sqlmesh.core.state_sync.common - INFO - Finalizing environment 'prod' (common.py:198)
