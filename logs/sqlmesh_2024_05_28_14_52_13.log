2024-05-28 14:52:13,118 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'data/catalog.db'} (connection.py:294)
2024-05-28 14:52:13,332 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: data/catalog.db (connection.py:290)
2024-05-28 14:52:16,856 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema catalog.sqlmesh__dtb (evaluator.py:265)
2024-05-28 14:52:16,857 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 14:52:16,858 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 14:52:16,860 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__dtb' AND table_name IN ('dtb__territorio__3564516099__temp', 'dtb__territorio__3564516099') (base.py:1822)
2024-05-28 14:52:16,894 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema catalog.sqlmesh__bps (evaluator.py:265)
2024-05-28 14:52:16,894 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 14:52:16,895 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 14:52:16,895 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__bps' AND table_name IN ('bps__unidades__3794497381', 'bps__precos__3689629057', 'bps__materiais__4088563816__temp', 'bps__materiais__4088563816', 'bps__precos__3689629057__temp', 'bps__unidades__3794497381__temp') (base.py:1822)
2024-05-28 14:52:16,900 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema catalog.sqlmesh__siasg (evaluator.py:265)
2024-05-28 14:52:16,901 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 14:52:16,901 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-05-28 14:52:16,901 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__siasg' AND table_name IN ('siasg__compras__1111392831', 'siasg__materiais__382104304__temp', 'siasg__uasgs__3746688468__temp', 'siasg__uasgs__3746688468', 'siasg__materiais__382104304', 'siasg__unidades__3458370508__temp', 'siasg__unidades__3458370508', 'siasg__compras__1111392831__temp') (base.py:1822)
2024-05-28 14:52:16,910 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'catalog.sqlmesh__bps' (evaluator.py:849)
2024-05-28 14:52:16,911 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "catalog"."sqlmesh__bps" (base.py:1822)
2024-05-28 14:52:16,911 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'catalog.sqlmesh__siasg' (evaluator.py:849)
2024-05-28 14:52:16,911 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "catalog"."sqlmesh__siasg" (base.py:1822)
2024-05-28 14:52:16,911 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'catalog.sqlmesh__dtb' (evaluator.py:849)
2024-05-28 14:52:16,911 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "catalog"."sqlmesh__dtb" (base.py:1822)
2024-05-28 14:52:16,924 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__bps.bps__precos__3689629057__temp' (evaluator.py:1155)
2024-05-28 14:52:16,926 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__bps"."bps__precos__3689629057__temp" AS SELECT CAST("_q_0"."data_compra" AS DATE) AS "data_compra", "_q_0"."codigo_compra" AS "codigo_compra", "_q_0"."codigo_item_compra" AS "codigo_item_compra", "_q_0"."codigo_item_catalogo" AS "codigo_item_catalogo", MD5(CONCAT("_q_0"."codigo_pdm", ';', "_q_0"."sigla_tipo_unidade_fornecimento", ';', "_q_0"."unidade_medida", ';', "_q_0"."capacidade_unidade_fornecimento")) AS "codigo_unidade_fornecimento", "_q_0"."codigo_uasg" AS "codigo_uasg", "_q_0"."cnpj_fornecedor" AS "cnpj_fornecedor", "_q_0"."fornecedor" AS "fornecedor", "_q_0"."marca_fabricante" AS "marca_fabricante", "_q_0"."quantidade" AS "quantidade", CAST("_q_0"."preco_unitario" AS DECIMAL(18, 2)) AS "preco_unitario" FROM (SELECT DISTINCT "c"."codigo_compra" AS "codigo_compra", "c"."codigo_item_compra" AS "codigo_item_compra", "c"."codigo_item_catalogo" AS "codigo_item_catalogo", "c"."sigla_tipo_unidade_fornecimento" AS "sigla_tipo_unidade_fornecimento", "c"."tipo_unidade_fornecimento" AS "tipo_unidade_fornecimento", "c"."unidade_medida" AS "unidade_medida", "c"."capacidade_unidade_fornecimento" AS "capacidade_unidade_fornecimento", "c"."quantidade" AS "quantidade", "c"."preco_unitario" AS "preco_unitario", "c"."cnpj_fornecedor" AS "cnpj_fornecedor", "c"."fornecedor" AS "fornecedor", "c"."marca_fabricante" AS "marca_fabricante", "c"."codigo_uasg" AS "codigo_uasg", "c"."data_compra" AS "data_compra", "m"."codigo_pdm" AS "codigo_pdm", "m"."descricao_item" AS "descricao_item" FROM (SELECT "compras"."idCompra" AS "codigo_compra", "compras"."idItemCompra" AS "codigo_item_compra", "compras"."codigoItemCatalogo" AS "codigo_item_catalogo", "compras"."siglaUnidadeFornecimento" AS "sigla_tipo_unidade_fornecimento", "compras"."nomeUnidadeFornecimento" AS "tipo_unidade_fornecimento", "compras"."siglaUnidadeMedida" AS "unidade_medida", "compras"."capacidadeUnidadeFornecimento" AS "capacidade_unidade_fornecimento", "compras"."quantidade" AS "quantidade", "compras"."precoUnitario" AS "preco_unitario", "compras"."niFornecedor" AS "cnpj_fornecedor", "compras"."nomeFornecedor" AS "fornecedor", "compras"."marca" AS "marca_fabricante", "compras"."codigoUasg" AS "codigo_uasg", "compras"."dataCompra" AS "data_compra" FROM "catalog"."sqlmesh__siasg"."siasg__compras__1111392831__temp" AS "compras" WHERE FALSE LIMIT 0) AS "c" LEFT JOIN "catalog"."sqlmesh__bps"."bps__materiais__4088563816__temp" AS "m" ON "c"."codigo_item_catalogo" = "m"."codigo_item_catalogo" WHERE FALSE LIMIT 0) AS "_q_0" WHERE FALSE ORDER BY "data_compra", "codigo_compra", "codigo_item_compra" LIMIT 0 (base.py:1822)
2024-05-28 14:52:16,938 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'catalog.sqlmesh__bps.bps__precos__3689629057' (evaluator.py:1155)
2024-05-28 14:52:16,940 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "catalog"."sqlmesh__bps"."bps__precos__3689629057" AS SELECT CAST("_q_0"."data_compra" AS DATE) AS "data_compra", "_q_0"."codigo_compra" AS "codigo_compra", "_q_0"."codigo_item_compra" AS "codigo_item_compra", "_q_0"."codigo_item_catalogo" AS "codigo_item_catalogo", MD5(CONCAT("_q_0"."codigo_pdm", ';', "_q_0"."sigla_tipo_unidade_fornecimento", ';', "_q_0"."unidade_medida", ';', "_q_0"."capacidade_unidade_fornecimento")) AS "codigo_unidade_fornecimento", "_q_0"."codigo_uasg" AS "codigo_uasg", "_q_0"."cnpj_fornecedor" AS "cnpj_fornecedor", "_q_0"."fornecedor" AS "fornecedor", "_q_0"."marca_fabricante" AS "marca_fabricante", "_q_0"."quantidade" AS "quantidade", CAST("_q_0"."preco_unitario" AS DECIMAL(18, 2)) AS "preco_unitario" FROM (SELECT DISTINCT "c"."codigo_compra" AS "codigo_compra", "c"."codigo_item_compra" AS "codigo_item_compra", "c"."codigo_item_catalogo" AS "codigo_item_catalogo", "c"."sigla_tipo_unidade_fornecimento" AS "sigla_tipo_unidade_fornecimento", "c"."tipo_unidade_fornecimento" AS "tipo_unidade_fornecimento", "c"."unidade_medida" AS "unidade_medida", "c"."capacidade_unidade_fornecimento" AS "capacidade_unidade_fornecimento", "c"."quantidade" AS "quantidade", "c"."preco_unitario" AS "preco_unitario", "c"."cnpj_fornecedor" AS "cnpj_fornecedor", "c"."fornecedor" AS "fornecedor", "c"."marca_fabricante" AS "marca_fabricante", "c"."codigo_uasg" AS "codigo_uasg", "c"."data_compra" AS "data_compra", "m"."codigo_pdm" AS "codigo_pdm", "m"."descricao_item" AS "descricao_item" FROM (SELECT "compras"."idCompra" AS "codigo_compra", "compras"."idItemCompra" AS "codigo_item_compra", "compras"."codigoItemCatalogo" AS "codigo_item_catalogo", "compras"."siglaUnidadeFornecimento" AS "sigla_tipo_unidade_fornecimento", "compras"."nomeUnidadeFornecimento" AS "tipo_unidade_fornecimento", "compras"."siglaUnidadeMedida" AS "unidade_medida", "compras"."capacidadeUnidadeFornecimento" AS "capacidade_unidade_fornecimento", "compras"."quantidade" AS "quantidade", "compras"."precoUnitario" AS "preco_unitario", "compras"."niFornecedor" AS "cnpj_fornecedor", "compras"."nomeFornecedor" AS "fornecedor", "compras"."marca" AS "marca_fabricante", "compras"."codigoUasg" AS "codigo_uasg", "compras"."dataCompra" AS "data_compra" FROM "catalog"."sqlmesh__siasg"."siasg__compras__1111392831__temp" AS "compras" WHERE FALSE LIMIT 0) AS "c" LEFT JOIN "catalog"."sqlmesh__bps"."bps__materiais__4088563816__temp" AS "m" ON "c"."codigo_item_catalogo" = "m"."codigo_item_catalogo" WHERE FALSE LIMIT 0) AS "_q_0" WHERE FALSE ORDER BY "data_compra", "codigo_compra", "codigo_item_compra" LIMIT 0 (base.py:1822)
2024-05-28 14:52:16,941 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON TABLE "catalog"."sqlmesh__bps"."bps__precos__3689629057" IS 'precos praticados em compras públicas na saúde' (base.py:1822)
2024-05-28 14:52:16,941 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057"."data_compra" IS 'data da compra (homologação do processo de compra)' (base.py:1822)
2024-05-28 14:52:16,941 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057"."codigo_compra" IS 'Identificador da compra (siasg)' (base.py:1822)
2024-05-28 14:52:16,941 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057"."codigo_item_compra" IS 'Identificador do item da compra (siasg)' (base.py:1822)
2024-05-28 14:52:16,942 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057"."codigo_item_catalogo" IS 'Código do item no catálogo (siasg); código da categoria do material' (base.py:1822)
2024-05-28 14:52:16,942 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057"."codigo_unidade_fornecimento" IS 'Identificador da unidade de fornecimento (bps)' (base.py:1822)
2024-05-28 14:52:16,942 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057"."codigo_uasg" IS 'identificador da unidade de gestão no governo (siasg)' (base.py:1822)
2024-05-28 14:52:16,942 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057"."cnpj_fornecedor" IS 'CNPJ do fornecedor (estrangeiros não possuem CNPJ)' (base.py:1822)
2024-05-28 14:52:16,943 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057"."fornecedor" IS 'nome do fornecedor' (base.py:1822)
2024-05-28 14:52:16,943 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057"."marca_fabricante" IS 'marca do item comprado' (base.py:1822)
2024-05-28 14:52:16,943 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057"."quantidade" IS 'quantidade compra (em unidades de fornecimento)' (base.py:1822)
2024-05-28 14:52:16,943 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057"."preco_unitario" IS 'preço de uma unidade de fornecimento do material comprado' (base.py:1822)
2024-05-28 14:52:16,957 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding dev interval (1716768000000, 1716854400000) for snapshot SnapshotId<"catalog"."bps"."unidades": 3948929169> (engine_adapter.py:651)
2024-05-28 14:52:16,962 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding dev interval (1716768000000, 1716854400000) for snapshot SnapshotId<"catalog"."bps"."materiais": 4069156962> (engine_adapter.py:651)
2024-05-28 14:52:16,965 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding dev interval (1716768000000, 1716854400000) for snapshot SnapshotId<"catalog"."siasg"."unidades": 459351842> (engine_adapter.py:651)
2024-05-28 14:52:16,969 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding dev interval (1716768000000, 1716854400000) for snapshot SnapshotId<"catalog"."siasg"."compras": 4190239739> (engine_adapter.py:651)
2024-05-28 14:52:16,972 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding dev interval (1716768000000, 1716854400000) for snapshot SnapshotId<"catalog"."siasg"."materiais": 3204375779> (engine_adapter.py:651)
2024-05-28 14:52:16,975 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding dev interval (1716768000000, 1716854400000) for snapshot SnapshotId<"catalog"."siasg"."uasgs": 2711588673> (engine_adapter.py:651)
2024-05-28 14:52:16,991 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"catalog"."bps"."precos": 4243261325> (evaluator.py:479)
2024-05-28 14:52:17,001 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-05-27 00:00:00+00:00, 2024-05-28 00:00:00+00:00) into catalog.sqlmesh__bps.bps__precos__3689629057__temp' (evaluator.py:504)
2024-05-28 14:52:17,001 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "catalog"."sqlmesh__bps"."bps__precos__3689629057__temp" (base.py:1822)
2024-05-28 14:52:17,003 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "catalog"."sqlmesh__bps"."bps__precos__3689629057__temp" AS SELECT CAST("_q_0"."data_compra" AS DATE) AS "data_compra", "_q_0"."codigo_compra" AS "codigo_compra", "_q_0"."codigo_item_compra" AS "codigo_item_compra", "_q_0"."codigo_item_catalogo" AS "codigo_item_catalogo", MD5(CONCAT("_q_0"."codigo_pdm", ';', "_q_0"."sigla_tipo_unidade_fornecimento", ';', "_q_0"."unidade_medida", ';', "_q_0"."capacidade_unidade_fornecimento")) AS "codigo_unidade_fornecimento", "_q_0"."codigo_uasg" AS "codigo_uasg", "_q_0"."cnpj_fornecedor" AS "cnpj_fornecedor", "_q_0"."fornecedor" AS "fornecedor", "_q_0"."marca_fabricante" AS "marca_fabricante", "_q_0"."quantidade" AS "quantidade", CAST("_q_0"."preco_unitario" AS DECIMAL(18, 2)) AS "preco_unitario" FROM (SELECT DISTINCT "c"."codigo_compra" AS "codigo_compra", "c"."codigo_item_compra" AS "codigo_item_compra", "c"."codigo_item_catalogo" AS "codigo_item_catalogo", "c"."sigla_tipo_unidade_fornecimento" AS "sigla_tipo_unidade_fornecimento", "c"."tipo_unidade_fornecimento" AS "tipo_unidade_fornecimento", "c"."unidade_medida" AS "unidade_medida", "c"."capacidade_unidade_fornecimento" AS "capacidade_unidade_fornecimento", "c"."quantidade" AS "quantidade", "c"."preco_unitario" AS "preco_unitario", "c"."cnpj_fornecedor" AS "cnpj_fornecedor", "c"."fornecedor" AS "fornecedor", "c"."marca_fabricante" AS "marca_fabricante", "c"."codigo_uasg" AS "codigo_uasg", "c"."data_compra" AS "data_compra", "m"."codigo_pdm" AS "codigo_pdm", "m"."descricao_item" AS "descricao_item" FROM (SELECT "compras"."idCompra" AS "codigo_compra", "compras"."idItemCompra" AS "codigo_item_compra", "compras"."codigoItemCatalogo" AS "codigo_item_catalogo", "compras"."siglaUnidadeFornecimento" AS "sigla_tipo_unidade_fornecimento", "compras"."nomeUnidadeFornecimento" AS "tipo_unidade_fornecimento", "compras"."siglaUnidadeMedida" AS "unidade_medida", "compras"."capacidadeUnidadeFornecimento" AS "capacidade_unidade_fornecimento", "compras"."quantidade" AS "quantidade", "compras"."precoUnitario" AS "preco_unitario", "compras"."niFornecedor" AS "cnpj_fornecedor", "compras"."nomeFornecedor" AS "fornecedor", "compras"."marca" AS "marca_fabricante", "compras"."codigoUasg" AS "codigo_uasg", "compras"."dataCompra" AS "data_compra" FROM "catalog"."sqlmesh__siasg"."siasg__compras__1111392831__temp" AS "compras") AS "c" LEFT JOIN "catalog"."sqlmesh__bps"."bps__materiais__4088563816__temp" AS "m" ON "c"."codigo_item_catalogo" = "m"."codigo_item_catalogo") AS "_q_0" ORDER BY "data_compra", "codigo_compra", "codigo_item_compra" (base.py:1822)
2024-05-28 14:52:17,007 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON TABLE "catalog"."sqlmesh__bps"."bps__precos__3689629057__temp" IS 'precos praticados em compras públicas na saúde' (base.py:1822)
2024-05-28 14:52:17,007 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057__temp"."data_compra" IS 'data da compra (homologação do processo de compra)' (base.py:1822)
2024-05-28 14:52:17,008 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057__temp"."codigo_compra" IS 'Identificador da compra (siasg)' (base.py:1822)
2024-05-28 14:52:17,008 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057__temp"."codigo_item_compra" IS 'Identificador do item da compra (siasg)' (base.py:1822)
2024-05-28 14:52:17,008 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057__temp"."codigo_item_catalogo" IS 'Código do item no catálogo (siasg); código da categoria do material' (base.py:1822)
2024-05-28 14:52:17,008 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057__temp"."codigo_unidade_fornecimento" IS 'Identificador da unidade de fornecimento (bps)' (base.py:1822)
2024-05-28 14:52:17,008 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057__temp"."codigo_uasg" IS 'identificador da unidade de gestão no governo (siasg)' (base.py:1822)
2024-05-28 14:52:17,009 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057__temp"."cnpj_fornecedor" IS 'CNPJ do fornecedor (estrangeiros não possuem CNPJ)' (base.py:1822)
2024-05-28 14:52:17,009 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057__temp"."fornecedor" IS 'nome do fornecedor' (base.py:1822)
2024-05-28 14:52:17,009 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057__temp"."marca_fabricante" IS 'marca do item comprado' (base.py:1822)
2024-05-28 14:52:17,009 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057__temp"."quantidade" IS 'quantidade compra (em unidades de fornecimento)' (base.py:1822)
2024-05-28 14:52:17,009 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "catalog"."sqlmesh__bps"."bps__precos__3689629057__temp"."preco_unitario" IS 'preço de uma unidade de fornecimento do material comprado' (base.py:1822)
2024-05-28 14:52:17,010 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding dev interval (1716768000000, 1716854400000) for snapshot SnapshotId<"catalog"."bps"."precos": 4243261325> (engine_adapter.py:651)
2024-05-28 14:52:17,017 - MainThread - sqlmesh.core.state_sync.common - INFO - Promoting environment 'dev' (common.py:120)
2024-05-28 14:52:17,028 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'catalog.siasg__dev' (evaluator.py:849)
2024-05-28 14:52:17,028 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "catalog"."siasg__dev" (base.py:1822)
2024-05-28 14:52:17,028 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'catalog.bps__dev' (evaluator.py:849)
2024-05-28 14:52:17,028 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "catalog"."bps__dev" (base.py:1822)
2024-05-28 14:52:17,029 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.siasg__dev.compras' to point at table 'catalog.sqlmesh__siasg.siasg__compras__1111392831__temp' (evaluator.py:1111)
2024-05-28 14:52:17,029 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."siasg__dev"."compras" AS SELECT * FROM "catalog"."sqlmesh__siasg"."siasg__compras__1111392831__temp" (base.py:1822)
2024-05-28 14:52:17,030 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.siasg__dev.materiais' to point at table 'catalog.sqlmesh__siasg.siasg__materiais__382104304__temp' (evaluator.py:1111)
2024-05-28 14:52:17,030 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."siasg__dev"."materiais" AS SELECT * FROM "catalog"."sqlmesh__siasg"."siasg__materiais__382104304__temp" (base.py:1822)
2024-05-28 14:52:17,031 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.siasg__dev.uasgs' to point at table 'catalog.sqlmesh__siasg.siasg__uasgs__3746688468__temp' (evaluator.py:1111)
2024-05-28 14:52:17,031 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."siasg__dev"."uasgs" AS SELECT * FROM "catalog"."sqlmesh__siasg"."siasg__uasgs__3746688468__temp" (base.py:1822)
2024-05-28 14:52:17,032 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.siasg__dev.unidades' to point at table 'catalog.sqlmesh__siasg.siasg__unidades__3458370508__temp' (evaluator.py:1111)
2024-05-28 14:52:17,032 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."siasg__dev"."unidades" AS SELECT * FROM "catalog"."sqlmesh__siasg"."siasg__unidades__3458370508__temp" (base.py:1822)
2024-05-28 14:52:17,034 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.bps__dev.materiais' to point at table 'catalog.sqlmesh__bps.bps__materiais__4088563816__temp' (evaluator.py:1111)
2024-05-28 14:52:17,034 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."bps__dev"."materiais" AS SELECT * FROM "catalog"."sqlmesh__bps"."bps__materiais__4088563816__temp" (base.py:1822)
2024-05-28 14:52:17,035 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.bps__dev.unidades' to point at table 'catalog.sqlmesh__bps.bps__unidades__3794497381__temp' (evaluator.py:1111)
2024-05-28 14:52:17,035 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."bps__dev"."unidades" AS SELECT * FROM "catalog"."sqlmesh__bps"."bps__unidades__3794497381__temp" (base.py:1822)
2024-05-28 14:52:17,036 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'catalog.bps__dev.precos' to point at table 'catalog.sqlmesh__bps.bps__precos__3689629057__temp' (evaluator.py:1111)
2024-05-28 14:52:17,036 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "catalog"."bps__dev"."precos" AS SELECT * FROM "catalog"."sqlmesh__bps"."bps__precos__3689629057__temp" (base.py:1822)
2024-05-28 14:52:17,037 - MainThread - sqlmesh.core.state_sync.common - INFO - Finalizing environment 'dev' (common.py:198)
2024-05-28 14:52:17,058 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
